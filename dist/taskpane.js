/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[926],{5338:function(e,t,r){var n=r(40961);t.H=n.createRoot,n.hydrateRoot},21020:function(e,t,r){var n=r(96540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},22799:function(e,t){if("function"==typeof Symbol&&Symbol.for){var r=Symbol.for;r("react.element"),r("react.portal"),r("react.fragment"),r("react.strict_mode"),r("react.profiler"),r("react.provider"),r("react.context"),r("react.forward_ref"),r("react.suspense"),r("react.suspense_list"),r("react.memo"),r("react.lazy"),r("react.block"),r("react.server.block"),r("react.fundamental"),r("react.debug_trace_mode"),r("react.legacy_hidden")}},39046:function(){},44363:function(e,t,r){r(22799)},74848:function(e,t,r){e.exports=r(21020)},80804:function(e,t,r){var n=r(96540),o=r.t(n,2),i=r(5338);const a={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},s=[a.OPENID_SCOPE,a.PROFILE_SCOPE,a.OFFLINE_ACCESS_SCOPE],c=[...s,a.EMAIL_SCOPE],l="Content-Type",u="Retry-After",h="X-AnchorMailbox",d="x-ms-request-id",g="x-ms-httpver",p="active-account-filters",f="common",m="organizations",y="consumers",v="access_token",b={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},w={PLAIN:"plain",S256:"S256"},k="query",C="Generic",I="-",S={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},T="appmetadata",x="1",A="authority-metadata",E="config",_="cache",P="network",R="hardcoded_values",O={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},N={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},M="throttling";var q;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(q||(q={}));class L{constructor(e,t,r){this.level=q.Info;const n=e||L.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:q.Info,this.correlationId=n.correlationId||a.EMPTY_STRING,this.packageName=t||a.EMPTY_STRING,this.packageVersion=r||a.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:q.Info}}clone(e,t,r){return new L({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${q[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:q.Error,containsPii:!1,correlationId:t||a.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:q.Error,containsPii:!0,correlationId:t||a.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:q.Warning,containsPii:!1,correlationId:t||a.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:q.Warning,containsPii:!0,correlationId:t||a.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:q.Info,containsPii:!1,correlationId:t||a.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:q.Info,containsPii:!0,correlationId:t||a.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:q.Verbose,containsPii:!1,correlationId:t||a.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:q.Verbose,containsPii:!0,correlationId:t||a.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:q.Trace,containsPii:!1,correlationId:t||a.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:q.Trace,containsPii:!0,correlationId:t||a.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const B="OIDC",H="EAR",F="none",D="unexpected_error",U="post_request_failed",z={[D]:"Unexpected error in authentication.",[U]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class j extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,j.prototype),this.errorCode=e||a.EMPTY_STRING,this.errorMessage=t||a.EMPTY_STRING,this.subError=r||a.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function $(e,t){return new j(e,t?`${z[e]} ${t}`:z[e])}const K="client_info_decoding_error",G="client_info_empty_error",W="token_parsing_error",Q="null_or_empty_token",V="endpoints_resolution_error",J="network_error",Y="openid_config_error",X="hash_not_deserialized",Z="invalid_state",ee="state_mismatch",te="state_not_found",re="nonce_mismatch",ne="auth_time_not_found",oe="max_age_transpired",ie="multiple_matching_tokens",ae="multiple_matching_accounts",se="multiple_matching_appMetadata",ce="request_cannot_be_made",le="cannot_remove_empty_scope",ue="cannot_append_scopeset",he="empty_input_scopeset",de="device_code_polling_cancelled",ge="device_code_expired",pe="device_code_unknown_error",fe="no_account_in_silent_request",me="invalid_cache_record",ye="invalid_cache_environment",ve="no_account_found",be="no_crypto_object",we="unexpected_credential_type",ke="invalid_assertion",Ce="invalid_client_credential",Ie="token_refresh_required",Se="user_timeout_reached",Te="token_claims_cnf_required_for_signedjwt",xe="authorization_code_missing_from_server_response",Ae="binding_key_not_removed",Ee="end_session_endpoint_not_supported",_e="key_id_missing",Pe="no_network_connectivity",Re="user_canceled",Oe="missing_tenant_id_error",Ne="method_not_implemented",Me="nested_app_auth_bridge_disabled",qe={[K]:"The client info could not be parsed/decoded correctly",[G]:"The client info was empty",[W]:"Token cannot be parsed",[Q]:"The token is null or empty",[V]:"Endpoints cannot be resolved",[J]:"Network request failed",[Y]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[X]:"The hash parameters could not be deserialized",[Z]:"State was not the expected format",[ee]:"State mismatch error",[te]:"State not found",[re]:"Nonce mismatch error",[ne]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[oe]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[ie]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ae]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[se]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[ce]:"Token request cannot be made without authorization code or refresh token.",[le]:"Cannot remove null or empty scope from ScopeSet",[ue]:"Cannot append ScopeSet",[he]:"Empty input ScopeSet cannot be processed",[de]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ge]:"Device code is expired.",[pe]:"Device code stopped polling for unknown reasons.",[fe]:"Please pass an account object, silent flow is not supported without account information",[me]:"Cache record object was null or undefined.",[ye]:"Invalid environment when attempting to create cache entry",[ve]:"No account found in cache for given key.",[be]:"No crypto object detected.",[we]:"Unexpected credential type.",[ke]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ce]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Ie]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Se]:"User defined timeout for device code polling reached",[Te]:"Cannot generate a POP jwt if the token_claims are not populated",[xe]:"Server response does not contain an authorization code to proceed",[Ae]:"Could not remove the credential's binding key from storage.",[Ee]:"The provided authority does not support logout",[_e]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Pe]:"No network connectivity. Check your internet connection.",[Re]:"User cancelled the flow.",[Oe]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Ne]:"This method has not been implemented",[Me]:"The nested app auth bridge is disabled"};class Le extends j{constructor(e,t){super(e,t?`${qe[e]}: ${t}`:qe[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Le.prototype)}}function Be(e,t){return new Le(e,t)}const He={createNewGuid:()=>{throw Be(Ne)},base64Decode:()=>{throw Be(Ne)},base64Encode:()=>{throw Be(Ne)},base64UrlEncode:()=>{throw Be(Ne)},encodeKid:()=>{throw Be(Ne)},async getPublicKeyThumbprint(){throw Be(Ne)},async removeTokenBindingKey(){throw Be(Ne)},async clearKeystore(){throw Be(Ne)},async signJwt(){throw Be(Ne)},async hashString(){throw Be(Ne)}},Fe="@azure/msal-common",De="15.6.0";function Ue(e,t){const r=function(e){if(!e)throw Be(Q);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Be(W);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw Be(W)}}function ze(e,t){if(0===t||Date.now()-3e5>e+t)throw Be(oe)}function je(){return Math.round((new Date).getTime()/1e3)}function $e(e){return e.getTime()/1e3}function Ke(e){return e?new Date(1e3*Number(e)):new Date}function Ge(e,t){const r=Number(e)||0;return je()+t>r}function We(e){return[Xe(e),Ze(e),et(e),tt(e),rt(e)].join(I).toLowerCase()}function Qe(e,t,r,n,o){return{credentialType:S.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function Ve(e,t,r,n,o,i,a,s,c,l,u,h,d,g,p){const f={homeAccountId:e,credentialType:S.ACCESS_TOKEN,secret:r,cachedAt:je().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||N.BEARER};if(h&&(f.userAssertionHash=h),l&&(f.refreshOn=l.toString()),g&&(f.requestedClaims=g,f.requestedClaimsHash=p),f.tokenType?.toLowerCase()!==N.BEARER.toLowerCase())switch(f.credentialType=S.ACCESS_TOKEN_WITH_AUTH_SCHEME,f.tokenType){case N.POP:const e=Ue(r,c);if(!e?.cnf?.kid)throw Be(Te);f.keyId=e.cnf.kid;break;case N.SSH:f.keyId=d}return f}function Je(e,t,r,n,o,i,a){const s={credentialType:S.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Ye(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Xe(e){return[e.homeAccountId,e.environment].join(I).toLowerCase()}function Ze(e){const t=e.credentialType===S.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(I).toLowerCase()}function et(e){return(e.target||"").toLowerCase()}function tt(e){return(e.requestedClaimsHash||"").toLowerCase()}function rt(e){return e.tokenType&&e.tokenType.toLowerCase()!==N.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function nt(){return je()+86400}function ot(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function it(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function at(e){return e.expiresAt<=je()}r(64583).Promise;const st="redirect_uri_empty",ct="claims_request_parsing_error",lt="authority_uri_insecure",ut="url_parse_error",ht="empty_url_error",dt="empty_input_scopes_error",gt="invalid_prompt_value",pt="invalid_claims",ft="token_request_empty",mt="logout_request_empty",yt="invalid_code_challenge_method",vt="pkce_params_missing",bt="invalid_cloud_discovery_metadata",wt="invalid_authority_metadata",kt="untrusted_authority",Ct="missing_ssh_jwk",It="missing_ssh_kid",St="missing_nonce_authentication_header",Tt="invalid_authentication_header",xt="cannot_set_OIDCOptions",At="cannot_allow_platform_broker",Et="authority_mismatch",_t={[st]:"A redirect URI is required for all calls, and none has been set.",[ct]:"Could not parse the given claims request object.",[lt]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[ut]:"URL could not be parsed into appropriate segments.",[ht]:"URL was empty or null.",[dt]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[gt]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[pt]:"Given claims parameter must be a stringified JSON object.",[ft]:"Token request was empty and not found in cache.",[mt]:"The logout request was null or undefined.",[yt]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[vt]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[bt]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[wt]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[kt]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Ct]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[It]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[St]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Tt]:"Invalid authentication header provided",[xt]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[At]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Et]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Pt extends j{constructor(e){super(e,_t[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Pt.prototype)}}function Rt(e){return new Pt(e)}class Ot{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Nt{constructor(e){const t=e?Ot.trimArrayEntries([...e]):[],r=t?Ot.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw Rt(dt);this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||a.EMPTY_STRING).split(" ");return new Nt(t)}static createSearchScopes(e){const t=new Nt(e);return t.containsOnlyOIDCScopes()?t.removeScope(a.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new Nt(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return c.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw Be(ue)}}removeScope(e){if(!e)throw Be(le);this.scopes.delete(e.trim())}removeOIDCScopes(){c.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw Be(he);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw Be(he);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):a.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Mt(e,t){if(!e)throw Be(G);try{const r=t(e);return JSON.parse(r)}catch(e){throw Be(K)}}function qt(e){if(!e)throw Be(K);const t=e.split(".",2);return{uid:t[0],utid:t.length<2?a.EMPTY_STRING:t[1]}}function Lt(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Bt(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:Lt(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:Lt(r,e)}}function Ht(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=Bt(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}function Ft(e){return e&&(e.tid||e.tfp||e.acr)||null}class Dt{generateAccountId(){return[this.homeAccountId,this.environment].join(I).toLowerCase()}generateAccountKey(){return Dt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(I).toLowerCase()}static createAccount(e,t,r){const n=new Dt;let o;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===B?n.authorityType=C:n.authorityType="MSSTS",e.clientInfo&&r&&(o=Mt(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw Be(ye);n.environment=i,n.realm=o?.utid||Ft(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=Bt(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new Dt;return n.authorityType=e.authorityType||C,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{const t=Mt(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function Ut(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function zt(e){if(!e||e.indexOf("=")<0)return null;try{const t=Ut(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw Be(X)}return null}function jt(e,t=!0,r){const n=new Array;return e.forEach(((e,o)=>{!t&&r&&o in r?n.push(`${o}=${e}`):n.push(`${o}=${encodeURIComponent(e)}`)})),n.join("&")}class $t{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Rt(ht);e.includes("#")||(this._urlString=$t.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Ot.endsWith(t,"?")?t=t.slice(0,-1):Ot.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ot.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw Rt(ut)}if(!e.HostNameAndPort||!e.PathSegments)throw Rt(ut);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Rt(lt)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return $t.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==f&&r[0]!==m||(r[0]=e),$t.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Rt(ut);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Rt(ut);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===a.FORWARD_SLASH){const r=new $t(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new $t(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!zt(e)}}const Kt={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Gt={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},Wt=new Set;function Qt(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=Vt(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function Vt(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}Gt.metadata.forEach((e=>{e.aliases.forEach((e=>{Wt.add(e)}))}));const Jt="cache_quota_exceeded",Yt="cache_error_unknown",Xt={[Jt]:"Exceeded cache storage capacity.",[Yt]:"Unexpected error occurred when using cache storage."};class Zt extends Error{constructor(e,t){const r=t||(Xt[e]?Xt[e]:Xt[Yt]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Zt.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}var er=r(64583).Promise;class tr{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(Fe,De),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort((e=>e.idTokenClaims?-1:1))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let o,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(o=Ue(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:(i=Ht(e,r,o,a?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let o=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=o.get(t);if(!e)return[];o=new Map([[t,e]])}const a=[];return o.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)})),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw Be(me);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new Zt(Jt)):new Zt(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new Zt(Yt))}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=Nt.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,r)&&Nt.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))})),await er.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,o)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(I).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(I).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(S.ID_TOKEN.toLowerCase())&&-1===t.indexOf(S.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(S.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(S.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(S.REFRESH_TOKEN.toLowerCase())>-1){const e=`${S.REFRESH_TOKEN}${I}${this.clientId}${I}`,r=`${S.REFRESH_TOKEN}${I}${x}${I}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===S.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===N.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await er.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await er.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===S.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===N.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw Be(Ae)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=Dt.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:S.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){const r=new Map;a.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=Nt.createSearchScopes(t.scopes),s=t.authenticationScheme||N.BEARER,c=s&&s.toLowerCase()!==N.BEARER.toLowerCase()?S.ACCESS_TOKEN_WITH_AUTH_SCHEME:S.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,h=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&h.push(t)}}));const d=h.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach((e=>{this.removeAccessToken(We(e))})),o&&i&&o.addFields({multiMatchedAT:h.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?x:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:S.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&n&&o&&n.addFields({multiMatchedRT:l},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),o=n.length;if(o<1)return null;if(o>1)throw Be(se);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==x)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new $t(n).getUrlComponents().HostNameAndPort;r=Qt(o,e.cloudDiscoveryMetadata?.metadata,E,t)||Qt(o,Gt.metadata,R,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==S.ACCESS_TOKEN&&e.credentialType!==S.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Nt.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(T)}isAuthorityMetadata(e){return-1!==e.indexOf(A)}generateAuthorityMetadataCacheKey(e){return`${A}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class rr extends tr{async setAccount(){throw Be(Ne)}getAccount(){throw Be(Ne)}async setIdTokenCredential(){throw Be(Ne)}getIdTokenCredential(){throw Be(Ne)}async setAccessTokenCredential(){throw Be(Ne)}getAccessTokenCredential(){throw Be(Ne)}async setRefreshTokenCredential(){throw Be(Ne)}getRefreshTokenCredential(){throw Be(Ne)}setAppMetadata(){throw Be(Ne)}getAppMetadata(){throw Be(Ne)}setServerTelemetry(){throw Be(Ne)}getServerTelemetry(){throw Be(Ne)}setAuthorityMetadata(){throw Be(Ne)}getAuthorityMetadata(){throw Be(Ne)}getAuthorityMetadataKeys(){throw Be(Ne)}setThrottlingCache(){throw Be(Ne)}getThrottlingCache(){throw Be(Ne)}removeItem(){throw Be(Ne)}getKeys(){throw Be(Ne)}getAccountKeys(){throw Be(Ne)}getTokenKeys(){throw Be(Ne)}}const nr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},or={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:q.Info,correlationId:a.EMPTY_STRING},ir={claimsBasedCachingEnabled:!1},ar={async sendGetRequestAsync(){throw Be(Ne)},async sendPostRequestAsync(){throw Be(Ne)}},sr={sku:a.SKU,version:De,cpu:a.EMPTY_STRING,os:a.EMPTY_STRING},cr={clientSecret:a.EMPTY_STRING,clientAssertion:void 0},lr={azureCloudInstance:F,tenant:`${a.DEFAULT_COMMON_TENANT}`},ur={application:{appName:"",appVersion:""}};function hr(e){return e.authOptions.authority.options.protocolMode===B}var dr=r(64583).Promise;const gr={sendGetRequestAsync:()=>dr.reject(Be(Ne)),sendPostRequestAsync:()=>dr.reject(Be(Ne))},pr="acquireTokenByCode",fr="acquireTokenByRefreshToken",mr="acquireTokenSilent",yr="acquireTokenSilentAsync",vr="acquireTokenPopup",br="acquireTokenRedirect",wr="cryptoOptsGetPublicKeyThumbprint",kr="cryptoOptsSignJwt",Cr="silentCacheClientAcquireToken",Ir="silentIframeClientAcquireToken",Sr="silentRefreshClientAcquireToken",Tr="ssoSilent",xr="standardInteractionClientGetDiscoveredAuthority",Ar="nativeInteractionClientAcquireToken",Er="networkClientSendPostRequestAsync",_r="refreshTokenClientExecutePostToTokenEndpoint",Pr="authorizationCodeClientExecutePostToTokenEndpoint",Rr="refreshTokenClientExecuteTokenRequest",Or="refreshTokenClientAcquireToken",Nr="refreshTokenClientAcquireTokenWithCachedRefreshToken",Mr="refreshTokenClientAcquireTokenByRefreshToken",qr="refreshTokenClientCreateTokenRequestBody",Lr="acquireTokenFromCache",Br="silentFlowClientAcquireCachedToken",Hr="silentFlowClientGenerateResultFromCacheRecord",Fr="acquireTokenBySilentIframe",Dr="initializeBaseRequest",Ur="initializeSilentRequest",zr="initializeClientApplication",jr="initializeCache",$r="silentIframeClientTokenHelper",Kr="silentHandlerInitiateAuthRequest",Gr="silentHandlerMonitorIframeForHash",Wr="silentHandlerLoadFrame",Qr="silentHandlerLoadFrameSync",Vr="standardInteractionClientCreateAuthCodeClient",Jr="standardInteractionClientGetClientConfiguration",Yr="standardInteractionClientInitializeAuthorizationRequest",Xr="getAuthCodeUrl",Zr="handleCodeResponseFromServer",en="handleCodeResponse",tn="handleResponseEar",rn="handleResponsePlatformBroker",nn="handleResponseCode",on="updateTokenEndpointAuthority",an="authClientAcquireToken",sn="authClientExecuteTokenRequest",cn="authClientCreateTokenRequestBody",ln="popTokenGenerateCnf",un="popTokenGenerateKid",hn="handleServerTokenResponse",dn="deserializeResponse",gn="authorityFactoryCreateDiscoveredInstance",pn="authorityResolveEndpointsAsync",fn="authorityGetCloudDiscoveryMetadataFromNetwork",mn="authorityUpdateCloudDiscoveryMetadata",yn="authorityGetEndpointMetadataFromNetwork",vn="authorityUpdateEndpointMetadata",bn="authorityUpdateMetadataWithRegionalInformation",wn="regionDiscoveryDetectRegion",kn="regionDiscoveryGetRegionFromIMDS",Cn="regionDiscoveryGetCurrentVersion",In="acquireTokenByCodeAsync",Sn="handleRedirectPromise",Tn="handleNativeRedirectPromise",xn="nativeMessageHandlerHandshake",An="removeHiddenIframe",En="clearTokensAndKeysWithClaims",_n="cacheManagerGetRefreshToken",Pn="importExistingCache",Rn="setUserData",On="localStorageUpdated",Nn="generatePkceCodes",Mn="generateCodeVerifier",qn="generateCodeChallengeFromVerifier",Ln="sha256Digest",Bn="getRandomValues",Hn="generateHKDF",Fn="generateBaseKey",Dn="base64Decode",Un="urlEncodeArr",zn="encrypt",jn="decrypt",$n="generateEarKey",Kn="decryptEarResponse",Gn=(new Map([[pr,"ATByCode"],[fr,"ATByRT"],[mr,"ATS"],[yr,"ATSAsync"],[vr,"ATPopup"],[br,"ATRedirect"],[wr,"CryptoGetPKThumb"],[kr,"CryptoSignJwt"],[Cr,"SltCacheClientAT"],[Ir,"SltIframeClientAT"],[Sr,"SltRClientAT"],[Tr,"SsoSlt"],[xr,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[Ar,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Er,"NetClientSendPost"],[_r,"RTClientExecPost"],[Pr,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Rr,"RTClientExecTReq"],[Or,"RTClientAT"],[Nr,"RTClientATWithCachedRT"],[Mr,"RTClientATByRT"],[qr,"RTClientCreateTReqBody"],[Lr,"ATFromCache"],[Br,"SltFlowClientATCached"],[Hr,"SltFlowClientGenResFromCache"],[Fr,"ATBySltIframe"],[Dr,"InitBaseReq"],[Ur,"InitSltReq"],[zr,"InitClientApplication"],[jr,"InitCache"],[Pn,"importCache"],[Rn,"setUserData"],[On,"localStorageUpdated"],[$r,"SIClientTHelper"],[Kr,"SHandlerInitAuthReq"],[Gr,"SltHandlerMonitorIframeForHash"],[Wr,"SHandlerLoadFrame"],[Qr,"SHandlerLoadFrameSync"],[Vr,"StdIntClientCreateAuthCodeClient"],[Jr,"StdIntClientGetClientConf"],[Yr,"StdIntClientInitAuthReq"],[Xr,"GetAuthCodeUrl"],[Zr,"HandleCodeResFromServer"],[en,"HandleCodeResp"],[tn,"HandleRespEar"],[nn,"HandleRespCode"],[rn,"HandleRespPlatBroker"],[on,"UpdTEndpointAuth"],[an,"AuthClientAT"],[sn,"AuthClientExecTReq"],[cn,"AuthClientCreateTReqBody"],[ln,"PopTGenCnf"],[un,"PopTGenKid"],[hn,"HandleServerTRes"],[dn,"DeserializeRes"],[gn,"AuthFactCreateDiscInst"],[pn,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[fn,"AuthGetCDMetaFromNet"],[mn,"AuthUpdCDMeta"],[yn,"AuthUpdCDMetaFromNet"],[vn,"AuthUpdEndpointMeta"],[bn,"AuthUpdMetaWithRegInfo"],[wn,"RegDiscDetectReg"],[kn,"RegDiscGetRegFromIMDS"],[Cn,"RegDiscGetCurrentVer"],[In,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Sn,"HandleRedirectPromise"],[Tn,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[xn,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[An,"RemoveHiddenIframe"],[En,"ClearTAndKeysWithClaims"],[_n,"CacheManagerGetRT"],[Nn,"GenPkceCodes"],[Mn,"GenCodeVerifier"],[qn,"GenCodeChallengeFromVerifier"],[Ln,"Sha256Digest"],[Bn,"GetRandomValues"],[Hn,"genHKDF"],[Fn,"genBaseKey"],[Dn,"b64Decode"],[Un,"urlEncArr"],[zn,"encrypt"],[jn,"decrypt"],[$n,"genEarKey"],[Kn,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class Wn{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Qn{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Gn,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Wn}}startPerformanceMeasurement(){return new Wn}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Vn="invalid_grant",Jn="msal",Yn="msal.js.browser",Xn="53ee284d-920a-4b59-9d30-a60315b26836",Zn="ppnbnpeolgkicgegkbkbjmhlideopiji",eo="Handshake",to="GetToken",ro="localStorage",no="sessionStorage",oo="memoryStorage",io="signin",ao="signout",so="request.origin",co="urlHash",lo="request.params",uo="code.verifier",ho="interaction.status",go="request.native",po="msal.account.keys",fo="msal.token.keys",mo="wrapper.sku",yo="wrapper.version",vo=861,bo=862;var wo;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(wo||(wo={}));const ko={scopes:s},Co="msal.db",Io=`${Co}.keys`,So=[0,5,4];var To=r(64583).Promise;class xo{navigateInternal(e,t){return xo.defaultNavigateWindow(e,t)}navigateExternal(e,t){return xo.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new To((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}class Ao extends j{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Ao.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function Eo(e,t,r,n){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${n?.name}, error.message:${n?.message}`,new Ao(e,t,r)}const _o="pkce_not_created",Po="ear_jwk_empty",Ro="ear_jwe_empty",Oo="crypto_nonexistent",No="empty_navigate_uri",Mo="hash_empty_error",qo="no_state_in_hash",Lo="hash_does_not_contain_known_properties",Bo="unable_to_parse_state",Ho="state_interaction_type_mismatch",Fo="interaction_in_progress",Do="popup_window_error",Uo="empty_window_error",zo="user_cancelled",jo="monitor_popup_timeout",$o="monitor_window_timeout",Ko="redirect_in_iframe",Go="block_iframe_reload",Wo="block_nested_popups",Qo="iframe_closed_prematurely",Vo="silent_logout_unsupported",Jo="no_account_error",Yo="silent_prompt_value_error",Xo="no_token_request_cache_error",Zo="unable_to_parse_token_request_cache_error",ei="auth_request_not_set_error",ti="invalid_cache_type",ri="non_browser_environment",ni="database_not_open",oi="no_network_connectivity",ii="post_request_failed",ai="get_request_failed",si="failed_to_parse_response",ci="unable_to_load_token",li="crypto_key_not_found",ui="auth_code_required",hi="auth_code_or_nativeAccountId_required",di="spa_code_and_nativeAccountId_present",gi="database_unavailable",pi="unable_to_acquire_token_from_native_platform",fi="native_handshake_timeout",mi="native_extension_not_installed",yi="native_connection_not_established",vi="uninitialized_public_client_application",bi="native_prompt_not_supported",wi="invalid_base64_string",ki="invalid_pop_token_request",Ci="failed_to_build_headers",Ii="failed_to_parse_headers",Si="failed_to_decrypt_ear_response",Ti="For more visit: aka.ms/msaljs/browser-errors",xi={[_o]:"The PKCE code challenge and verifier could not be generated.",[Po]:"No EAR encryption key provided. This is unexpected.",[Ro]:"Server response does not contain ear_jwe property. This is unexpected.",[Oo]:"The crypto object or function is not available.",[No]:"Navigation URI is empty. Please check stack trace for more info.",[Mo]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Ti}`,[qo]:"Hash does not contain state. Please verify that the request originated from msal.",[Lo]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Ti}`,[Bo]:"Unable to parse state. Please verify that the request originated from msal.",[Ho]:"Hash contains state but the interaction type does not match the caller.",[Fo]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Ti}`,[Do]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Uo]:"window.open returned null or undefined window object.",[zo]:"User cancelled the flow.",[jo]:`Token acquisition in popup failed due to timeout.  ${Ti}`,[$o]:`Token acquisition in iframe failed due to timeout.  ${Ti}`,[Ko]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Go]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Ti}`,[Wo]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Qo]:"The iframe being monitored was closed prematurely.",[Vo]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Jo]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Yo]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Xo]:"No token request found in cache.",[Zo]:"The cached token request could not be parsed.",[ei]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[ti]:"Invalid cache type",[ri]:"Login and token requests are not supported in non-browser environments.",[ni]:"Database is not open!",[oi]:"No network connectivity. Check your internet connection.",[ii]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[ai]:"Network request failed. Please check the network trace to determine root cause.",[si]:"Failed to parse network response. Check network trace.",[ci]:"Error loading token to cache.",[li]:"Cryptographic Key or Keypair not found in browser storage.",[ui]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[hi]:"An authorization code or nativeAccountId must be provided to this flow.",[di]:"Request cannot contain both spa code and native account id.",[gi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[pi]:`Unable to acquire token from native platform.  ${Ti}`,[fi]:"Timed out while attempting to establish connection to browser extension",[mi]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[yi]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Ti}`,[vi]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Ti}`,[bi]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[wi]:"Invalid base64 encoded string.",[ki]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Ci]:"Failed to build request headers object.",[Ii]:"Failed to parse response headers",[Si]:"Failed to decrypt ear response"};class Ai extends j{constructor(e,t){super(e,xi[e],t),Object.setPrototypeOf(this,Ai.prototype),this.name="BrowserAuthError"}}function Ei(e,t){return new Ai(e,t)}class _i{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=Pi(t);try{r=await fetch(e,{method:"GET",headers:i})}catch(e){throw Eo(Ei(window.navigator.onLine?ai:oi),void 0,void 0,e)}n=Ri(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw Eo(Ei(si),o,n,e)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=Pi(t);let o,i=0,a={};try{o=await fetch(e,{method:"POST",headers:n,body:r})}catch(e){throw Eo(Ei(window.navigator.onLine?ii:oi),void 0,void 0,e)}a=Ri(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw Eo(Ei(si),i,a,e)}}}function Pi(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach((([e,r])=>{t.append(e,r)})),t}catch(e){throw Eo(Ei(Ci),void 0,void 0,e)}}function Ri(e){try{const t={};return e.forEach(((e,r)=>{t[r]=e})),t}catch(e){throw Ei(Ii)}}function Oi(e){return encodeURIComponent(Mi(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Ni(e){return qi(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Mi(e){return qi((new TextEncoder).encode(e))}function qi(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function Li(e){return(new TextDecoder).decode(Bi(e))}function Bi(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Ei(wi)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}const Hi="AES-GCM",Fi="HKDF",Di="SHA-256",Ui=new Uint8Array([1,0,1]),zi="0123456789abcdef",ji=new Uint32Array(1),$i="raw",Ki="encrypt",Gi="decrypt",Wi={name:"RSASSA-PKCS1-v1_5",hash:Di,modulusLength:2048,publicExponent:Ui};async function Qi(e,t,r){t?.addQueueMeasurement(Ln,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(Di,n)}function Vi(e){return window.crypto.getRandomValues(e)}function Ji(){return window.crypto.getRandomValues(ji),ji[0]}function Yi(){const e=Date.now(),t=1024*Ji()+(1023&Ji()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=Ji();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=zi.charAt(r[e]>>>4),a+=zi.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function Xi(e){return window.crypto.subtle.exportKey("jwk",e)}async function Zi(){const e=await ta(),t={alg:"dir",kty:"oct",k:Ni(new Uint8Array(e))};return Mi(JSON.stringify(t))}async function ea(e,t){const r=t.split(".");if(5!==r.length)throw Ei(Si,"jwe_length");const n=await async function(e){const t=Li(e),r=Bi(JSON.parse(t).k);return window.crypto.subtle.importKey($i,r,Hi,!1,[Gi])}(e).catch((()=>{throw Ei(Si,"import_key")}));try{const e=(new TextEncoder).encode(r[0]),t=Bi(r[2]),o=Bi(r[3]),i=Bi(r[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:Hi,iv:t,tagLength:a,additionalData:e},n,s);return(new TextDecoder).decode(c)}catch(e){throw Ei(Si,"decrypt")}}async function ta(){const e=await window.crypto.subtle.generateKey({name:Hi,length:256},!0,[Ki,Gi]);return window.crypto.subtle.exportKey($i,e)}async function ra(e){return window.crypto.subtle.importKey($i,e,Fi,!1,["deriveKey"])}async function na(e,t,r){return window.crypto.subtle.deriveKey({name:Fi,salt:t,hash:Di,info:(new TextEncoder).encode(r)},e,{name:Hi,length:256},!1,[Ki,Gi])}async function oa(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await na(e,o,r),a=await window.crypto.subtle.encrypt({name:Hi,iv:new Uint8Array(12)},i,n);return{data:Ni(new Uint8Array(a)),nonce:Ni(o)}}async function ia(e,t,r,n){const o=Bi(n),i=await na(e,Bi(t),r),a=await window.crypto.subtle.decrypt({name:Hi,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function aa(e){const t=await Qi(e);return Ni(new Uint8Array(t))}const sa="storage_not_supported",ca="stubbed_public_client_application_called",la="in_mem_redirect_unavailable",ua={[sa]:"Given storage configuration option was not supported.",[ca]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[la]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class ha extends j{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,ha.prototype)}}function da(e){return new ha(e,ua[e])}function ga(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function pa(){return window.parent!==window}function fa(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function ma(){if("undefined"==typeof window)throw Ei(ri)}function ya(e){if(!e)throw Ei(vi)}function va(e){ma(),function(){if($t.hashContainsKnownProperties(window.location.hash)&&pa())throw Ei(Go)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${Jn}.`))throw Ei(Wo)}(),ya(e)}function ba(e,t){if(va(e),function(e){if(pa()&&!e)throw Ei(Ko)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===oo&&!t.cache.storeAuthStateInCookie)throw da(la)}function wa(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const ka="4.12.0";class Ca{static loggerCallback(e,t){switch(e){case q.Error:return void console.error(t);case q.Info:return void console.info(t);case q.Verbose:return void console.debug(t);case q.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){const i={clientId:a.EMPTY_STRING,authority:`${a.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:a.EMPTY_STRING,authorityMetadata:a.EMPTY_STRING,redirectUri:"undefined"!=typeof window?fa():"",postLogoutRedirectUri:a.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[a.OPENID_SCOPE,a.PROFILE_SCOPE,a.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:F,tenant:a.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},s={cacheLocation:no,temporaryCacheLocation:no,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==ro),claimsBasedCachingEnabled:!1},c={loggerCallback:()=>{},logLevel:q.Info,piiLoggingEnabled:!1},l={...{...nr,loggerOptions:c,networkClient:o?new _i:gr,navigationClient:new xo,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...r,loggerOptions:r?.loggerOptions||c},u={application:{appName:a.EMPTY_STRING,appVersion:a.EMPTY_STRING},client:new Qn};if(e?.protocolMode!==B&&e?.OIDCOptions&&new L(l.loggerOptions).warning(JSON.stringify(Rt(xt))),e?.protocolMode&&e.protocolMode===B&&l?.allowPlatformBroker)throw Rt(At);return{auth:{...i,...e,OIDCOptions:{...i.OIDCOptions,...e?.OIDCOptions}},cache:{...s,...t},system:l,telemetry:{...u,...n}}}(e,this.browserEnvironment);try{t=window[no]}catch(e){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),o="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},s=r&&Object.keys(q).includes(r)?q[r]:void 0;s&&(i.loggerCallback=Ca.loggerCallback,i.logLevel=s),void 0!==o&&(i.piiLoggingEnabled=o),this.logger=new L(i,"@azure/msal-browser",ka),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Ia extends Ca{getModuleName(){return Ia.MODULE_NAME}getId(){return Ia.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}Ia.MODULE_NAME="",Ia.ID="StandardOperatingContext";const Sa="missing_kid_error",Ta="missing_alg_error",xa={[Sa]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Ta]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Aa extends j{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Aa.prototype)}}function Ea(e){return new Aa(e,xa[e])}class _a{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ea(Sa);if(!e.alg)throw Ea(Ta);const t=new _a({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}var Pa=r(64583).Promise;class Ra{constructor(){this.dbName=Co,this.version=1,this.tableName=Io,this.dbOpen=!1}async open(){return new Pa(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(Ei(gi))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Pa(((t,r)=>{if(!this.db)return r(Ei(ni));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Pa(((r,n)=>{if(!this.db)return n(Ei(ni));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",(()=>{this.closeConnection(),r()})),o.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Pa(((t,r)=>{if(!this.db)return r(Ei(ni));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Pa(((e,t)=>{if(!this.db)return t(Ei(ni));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Pa(((t,r)=>{if(!this.db)return r(Ei(ni));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Pa(((e,t)=>{const r=window.indexedDB.deleteDatabase(Co),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}class Oa{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Na{constructor(e){this.inMemoryCache=new Oa,this.indexedDBCache=new Ra,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Ai&&e.errorCode===gi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Ma{constructor(e,t,r){this.logger=e,function(e){if(!window)throw Ei(ri);if(!window.crypto)throw Ei(Oo);if(!e&&!window.crypto.subtle)throw Ei(Oo,"crypto_subtle_undefined")}(r??!1),this.cache=new Na(this.logger),this.performanceClient=t}createNewGuid(){return Yi()}base64Encode(e){return Mi(e)}base64Decode(e){return Li(e)}base64UrlEncode(e){return Oi(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(wr,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(Wi,e,t)}(Ma.EXTRACTABLE,Ma.POP_KEY_USAGES),n=await Xi(r.publicKey),o=qa({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await Xi(r.privateKey),s=await async function(e){return window.crypto.subtle.importKey("jwk",e,Wi,!1,["sign"])}(a);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(kr,n),i=await this.cache.getItem(t);if(!i)throw Ei(li);const a=await Xi(i.publicKey),s=qa(a),c=Oi(JSON.stringify({kid:t})),l=Oi(_a.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${Oi(JSON.stringify(e))}`,h=(new TextEncoder).encode(u),d=await async function(e,t){return window.crypto.subtle.sign(Wi,e,t)}(i.privateKey,h),g=`${u}.${Ni(new Uint8Array(d))}`;return o&&o.end({success:!0}),g}async hashString(e){return aa(e)}}function qa(e){return JSON.stringify(e,Object.keys(e).sort())}Ma.POP_KEY_USAGES=["sign","verify"],Ma.EXTRACTABLE=!0;const La=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Ba=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then((e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}))};class Ha{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(wn,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=Ha.IMDS_OPTIONS;try{const n=await Ba(this.getRegionFromIMDS.bind(this),kn,this.logger,this.performanceClient,this.correlationId)(a.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await Ba(this.getCurrentVersion.bind(this),Cn,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const o=await Ba(this.getRegionFromIMDS.bind(this),kn,this.logger,this.performanceClient,this.correlationId)(n,e);200===o.status&&(r=o.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(kn,this.correlationId),this.networkInterface.sendGetRequestAsync(`${a.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,a.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Cn,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${a.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}Ha.IMDS_OPTIONS={headers:{Metadata:"true"}};class Fa{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Ha(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(a.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case a.ADFS:return 1;case a.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new $t(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Be(V)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Be(V)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Be(V)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Be(Ee);return this.replacePath(this.metadata.end_session_endpoint)}throw Be(V)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Be(V)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Be(V)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Fa.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==B}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new $t(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new $t(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===B&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(pn,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Ba(this.updateCloudDiscoveryMetadata.bind(this),mn,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await Ba(this.updateEndpointMetadata.bind(this),vn,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:nt(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==_&&r?.source!==_&&(e.expiresAt=nt(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(vn,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===R&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(ot(e,await Ba(this.updateMetadataWithRegionalInformation.bind(this),bn,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await Ba(this.getEndpointMetadataFromNetwork.bind(this),yn,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await Ba(this.updateMetadataWithRegionalInformation.bind(this),bn,this.logger,this.performanceClient,this.correlationId)(r)),ot(e,r,!0),P;throw Be(Y,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),ot(e,t,!1),{source:E};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return ot(e,t,!1),{source:R,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=at(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:_}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new $t(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Rt(wt)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(yn,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Kt?Kt[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(bn,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==a.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,Fa.replaceWithRegionalInformation(e,t);const r=await Ba(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),wn,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,Fa.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(mn,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await Ba(this.getCloudDiscoveryMetadataFromNetwork.bind(this),fn,this.logger,this.performanceClient,this.correlationId)();if(r)return it(e,r,!0),P;throw Rt(kt)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||a.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||a.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||a.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),it(e,t,!1),E;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,Vt(Gt.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),it(e,t,!1),R;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=at(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),_):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Fa.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=Vt(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Rt(bt)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Fa.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(fn,this.correlationId);const e=`${a.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))o=n.body,i=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),o=n.body,o.error===a.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Vt(i,this.hostnameAndPort)}catch(e){if(e instanceof j)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=Fa.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&$t.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==F){const e=t.tenant?t.tenant:a.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return a.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Be(V)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Wt.has(e)}static isPublicCloudAuthority(e){return a.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new $t(e);n.validateAsUri();const o=n.getUrlComponents();let i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${a.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=$t.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${s}?${r}`:s}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=Fa.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=Fa.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=Fa.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new $t(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith(a.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${a.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function Da(e){return e.endsWith(a.FORWARD_SLASH)?e:`${e}${a.FORWARD_SLASH}`}Fa.reservedTenantDomains=new Set(["{tenant}","{tenantid}",f,y,m]);const Ua="no_tokens_found",za="native_account_unavailable",ja="refresh_token_expired",$a="bad_token",Ka=["interaction_required","consent_required","login_required",$a],Ga=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Wa={[Ua]:"No refresh token found in the cache. Please sign-in.",[za]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[ja]:"Refresh token has expired.",[$a]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Qa extends j{constructor(e,t,r,n,o,i,s,c){super(e,t,r),Object.setPrototypeOf(this,Qa.prototype),this.timestamp=n||a.EMPTY_STRING,this.traceId=o||a.EMPTY_STRING,this.correlationId=i||a.EMPTY_STRING,this.claims=s||a.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function Va(e,t,r){const n=!!e&&Ka.indexOf(e)>-1,o=!!r&&Ga.indexOf(r)>-1,i=!!t&&Ka.some((e=>t.indexOf(e)>-1));return n||i||o}function Ja(e){return new Qa(e,Wa[e])}function Ya(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}var Xa=r(64583).Promise;const Za="None";class es{initialize(){return Xa.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw Be(Ne)}setItem(e,t,r,n=!0,o="Lax"){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+=`expires=${e};`}(n||o===Za)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Xa.reject(Be(Ne))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach((e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])})),t}containsKey(e){return this.getKeys().includes(e)}}function ts(e){const t=e.getItem(po);return t?JSON.parse(t):[]}function rs(e,t){const r=t.getItem(`${fo}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}var ns=r(64583).Promise;const os="msal.cache.encryption";class is{constructor(e,t,r){if(!window.localStorage)throw da(sa);this.memoryStorage=new Oa,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new es,r=t.getItem(os);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=La(Bi,Dn,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await Ba(ra,Hn,this.logger,this.performanceClient,e)(t)},await Ba(this.importExistingCache.bind(this),Pn,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=Yi(),n=await Ba(ta,Fn,this.logger,this.performanceClient,e)(),o=La(Ni,Un,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await Ba(ra,Hn,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(os,JSON.stringify(i),0,!0,Za)}this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ei(vi);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw Ei(vi);const{data:n,nonce:o}=await Ba(oa,zn,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),ts(this).forEach((e=>this.removeItem(e)));const e=rs(this.clientId,this);e.idToken.forEach((e=>this.removeItem(e))),e.accessToken.forEach((e=>this.removeItem(e))),e.refreshToken.forEach((e=>this.removeItem(e))),this.getKeys().forEach((e=>{(e.startsWith(a.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)}))}async importExistingCache(e){if(!this.encryptionCookie)return;let t=ts(this);t=await this.importArray(t,e),this.setItem(po,JSON.stringify(t));const r=rs(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${fo}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Ba(ia,jn,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach((e=>{const o=this.getItemFromEncryptedCache(e,t).then((t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)}));n.push(o)})),await ns.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(On);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class as{constructor(){if(!window.sessionStorage)throw da(sa)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const ss="msal:initializeEnd",cs="msal:accountAdded",ls="msal:accountRemoved",us="msal:activeAccountChanged",hs="msal:loginStart",ds="msal:loginSuccess",gs="msal:loginFailure",ps="msal:acquireTokenStart",fs="msal:acquireTokenSuccess",ms="msal:acquireTokenFailure",ys="msal:acquireTokenByCodeFailure",vs="msal:handleRedirectEnd",bs="msal:popupOpened",ws="msal:logoutStart",ks="msal:logoutSuccess",Cs="msal:logoutFailure",Is="msal:logoutEnd";var Ss=r(64583).Promise;class Ts extends tr{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new Oa,this.browserStorage=xs(e,t.cacheLocation,n,o),this.temporaryCacheStorage=xs(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new es,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&Dt.isAccountEntity(r)?tr.toObject(new Dt,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();await Ba(this.browserStorage.setUserData.bind(this.browserStorage),Rn,this.logger,this.performanceClient)(r,JSON.stringify(e),t);const n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===ro&&n&&this.eventHandler.emitEvent(cs,void 0,e.getAccountInfo())}getAccountKeys(){return ts(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return-1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(po,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(po,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===ro&&this.eventHandler.emitEvent(ls,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,S.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,S.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,S.REFRESH_TOKEN)}getTokenKeys(){return rs(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case S.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case S.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case S.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Be(we)}this.browserStorage.setItem(`${fo}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case S.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case S.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case S.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),Be(we)}this.browserStorage.setItem(`${fo}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Ye(n)&&n.hasOwnProperty("realm")&&n.credentialType===S.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.ID_TOKEN),null);var n}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=We(e);await Ba(this.browserStorage.setUserData.bind(this.browserStorage),Rn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,S.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Ye(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===S.ACCESS_TOKEN||n.credentialType===S.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.ACCESS_TOKEN),null);var n}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=We(e);await Ba(this.browserStorage.setUserData.bind(this.browserStorage),Rn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,S.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Ye(n)&&n.credentialType===S.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,S.REFRESH_TOKEN),null);var n}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=We(e);await Ba(this.browserStorage.setUserData.bind(this.browserStorage),Rn,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,S.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf(T)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function({environment:e,clientId:t}){return[T,e,t].join(I).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(O.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(A)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(mo,e),this.internalStorage.setItem(yo,t)}getWrapperMetadata(){return[this.internalStorage.getItem(mo)||a.EMPTY_STRING,this.internalStorage.getItem(yo)||a.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(p),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(p);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(us)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(M));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===ro){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf(a.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf(a.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(En,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await Ss.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Ot.startsWith(e,a.CACHE_PREFIX)?e:`${a.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(lo)),this.removeTemporaryItem(this.generateCacheKey(uo)),this.removeTemporaryItem(this.generateCacheKey(so)),this.removeTemporaryItem(this.generateCacheKey(co)),this.removeTemporaryItem(this.generateCacheKey(go)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=Mi(JSON.stringify(e));if(this.setTemporaryCache(lo,r,!0),t){const e=Mi(t);this.setTemporaryCache(uo,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(lo,!0);if(!e)throw Ei(Xo);const t=this.getTemporaryCache(uo,!0);let r,n="";try{r=JSON.parse(Li(e)),t&&(n=Li(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),Ei(Zo)}return[r,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(go,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;return this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${a.CACHE_PREFIX}.${ho}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),ga(window),null}}setInteractionInProgress(e,t=io){const r=`${a.CACHE_PREFIX}.${ho}`;if(e){if(this.getInteractionInProgress())throw Ei(Fo);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){const r=Qe(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:Ve(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?$e(e.expiresOn):0,e.extExpiresOn?$e(e.extExpiresOn):0,Li,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof Zt&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function xs(e,t,r,n){try{switch(t){case ro:return new is(e,r,n);case no:return new as}}catch(e){r.error(e)}return new Oa}class As{constructor(e){this.eventCallbacks=new Map,this.logger=e||new L({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||Yi();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case cs:case ls:case us:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))}))}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const Es="home_account_id",_s="UPN",Ps="client_id",Rs="redirect_uri",Os="token_type",Ns="req_cnf",Ms="return_spa_code",qs="x-client-xtra-sku",Ls="brk_client_id",Bs="brk_redirect_uri",Hs="instance_aware";function Fs(e,t,r){if(!t)return;const n=e.get(Ps);n&&e.has(Ls)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(Rs)},t)}function Ds(e,t){e.set("response_type",t)}function Us(e,t,r=!0,n=s){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new Nt(o);e.set("scope",i.printScopes())}function zs(e,t){e.set(Ps,t)}function js(e,t){e.set(Rs,t)}function $s(e,t){e.set("login_hint",t)}function Ks(e,t){e.set(h,`UPN:${t}`)}function Gs(e,t){e.set(h,`Oid:${t.uid}@${t.utid}`)}function Ws(e,t){e.set("sid",t)}function Qs(e,t,r){const n=function(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw Rt(pt)}else r={};return t&&t.length>0&&(r.hasOwnProperty(v)||(r[v]={}),r[v].xms_cc={values:t}),JSON.stringify(r)}(t,r);try{JSON.parse(n)}catch(e){throw Rt(pt)}e.set("claims",n)}function Vs(e,t){e.set("client-request-id",t)}function Js(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function Ys(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function Xs(e,t){t&&e.set("state",t)}function Zs(e,t){e.set("client_secret",t)}function ec(e,t){t&&e.set("client_assertion",t)}function tc(e,t){t&&e.set("client_assertion_type",t)}function rc(e,t){e.set("grant_type",t)}function nc(e){e.set("client_info","1")}function oc(e){e.has(Hs)||e.set(Hs,"true")}function ic(e,t){Object.entries(t).forEach((([t,r])=>{!e.has(t)&&r&&e.set(t,r)}))}function ac(e,t){t&&(e.set(Os,N.POP),e.set(Ns,t))}function sc(e,t){t&&(e.set(Os,N.SSH),e.set(Ns,t))}function cc(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function lc(e){e.set("x-ms-lib-capability","retry-after, h429")}function uc(e,t,r){e.has(Ls)||e.set(Ls,t),e.has(Bs)||e.set(Bs,r)}async function hc(e,t,r,n,o,i,a){a?.addQueueMeasurement(gn,i);const s=Fa.transformCIAMAuthority(Da(e)),c=new Fa(s,t,r,n,o,i,a);try{return await Ba(c.resolveEndpointsAsync.bind(c),pn,o,a,i)(),c}catch(e){throw Be(V)}}class dc extends j{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,dc.prototype)}}class gc{static generateThrottlingStorageKey(e){return`${M}.${JSON.stringify(e)}`}static preProcess(e,t){const r=gc.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new dc(n.errorCodes?.join(" ")||a.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(gc.checkResponseStatus(r)||gc.checkResponseForRetryAfter(r)){const n={throttleTime:gc.calculateThrottleTime(parseInt(r.headers[u])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(gc.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(u)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const o=Ya(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}class pc{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:h,serializableCache:d}){const g={...or,...r};return{authOptions:(p=e,{clientCapabilities:[],azureCloudOptions:lr,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...p}),systemOptions:{...nr,...t},loggerOptions:g,cacheOptions:{...ir,...n},storageInterface:o||new rr(e.clientId,He,new L(g)),networkInterface:i||ar,cryptoInterface:a||He,clientCredentials:s||cr,libraryInfo:{...sr,...c},telemetry:{...ur,...l},serverTelemetryManager:u||null,persistencePlugin:h||null,serializableCache:d||null};var p}(e),this.logger=new L(this.config.loggerOptions,Fe,De),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[l]=a.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Es:try{const r=qt(e.credential);t[h]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case _s:t[h]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;gc.preProcess(this.cacheManager,e);try{o=await Ba(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Er,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[g]||"",requestId:e[d]||""},n)}catch(e){if(e instanceof Ao){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[g]||"",requestId:t[d]||"",contentTypeHeader:t[l]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof j?e:Be(J)}return gc.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(on,t);const r=`https://${e}/${this.authority.tenant}/`,n=await hc(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&uc(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&ic(t,e.tokenQueryParameters),Vs(t,e.correlationId),Fs(t,e.correlationId,this.performanceClient),jt(t)}}class fc{static setRequestState(e,t,r){const n=fc.generateLibraryState(e,r);return t?`${n}${a.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw Be(be);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw Be(be);if(!t)throw Be(Z);try{const r=t.split(a.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(a.RESOURCE_DELIM):a.EMPTY_STRING,i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:o||a.EMPTY_STRING,libraryState:s}}catch(e){throw Be(Z)}}}class mc{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(ln,e.correlationId);const r=await Ba(this.generateKid.bind(this),ln,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(un,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,l=i?new $t(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:je(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}class yc{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class vc{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||a.NOT_AVAILABLE} - Timestamp: ${e.timestamp||a.NOT_AVAILABLE} - Description: ${e.error_description||a.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||a.NOT_AVAILABLE} - Trace ID: ${e.trace_id||a.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new dc(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${o}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${o}`);if(Va(e.error,e.error_description,e.suberror))throw new Qa(e.error,e.error_description,e.suberror,e.timestamp||a.EMPTY_STRING,e.trace_id||a.EMPTY_STRING,e.correlation_id||a.EMPTY_STRING,e.claims||a.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,s,c,l){let u,h;if(this.performanceClient?.addQueueMeasurement(hn,e.correlation_id),e.id_token){if(u=Ue(e.id_token||a.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&u.nonce!==o.nonce)throw Be(re);if(n.maxAge||0===n.maxAge){const e=u.auth_time;if(!e)throw Be(ne);ze(e,n.maxAge)}}this.homeAccountIdentifier=Dt.generateHomeAccountId(e.client_info||a.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),o&&o.state&&(h=fc.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;const d=this.generateCacheRecord(e,t,r,n,u,i,o);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new yc(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),s&&!c&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await vc.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,u,h,void 0,l)}await this.cacheStorage.saveCacheRecord(d,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return vc.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,u,h,e,l)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw Be(ye);const c=Ft(o);let l,u;e.id_token&&o&&(l=Qe(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=bc(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,s,c,a,void 0,this.logger));let h=null;if(e.access_token){const o=e.scope?Nt.fromString(e.scope):new Nt(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,d=r+a,g=d+l,p=u&&u>0?r+u:void 0;h=Ve(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),d,g,this.cryptoObj.base64Decode,p,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let d=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),d=Je(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:h,refreshToken:d,appMetadata:g}}static async generateAuthenticationResult(e,t,r,n,o,i,s,c,l){let u,h,d=a.EMPTY_STRING,g=[],p=null,f=a.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==N.POP||o.popKid)d=r.accessToken.secret;else{const t=new mc(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw Be(_e);d=await t.signPopToken(n,i,o)}g=Nt.fromString(r.accessToken.target).asArray(),p=Ke(r.accessToken.expiresOn),u=Ke(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(h=Ke(r.accessToken.refreshOn))}r.appMetadata&&(f=r.appMetadata.familyId===x?x:"");const m=i?.oid||i?.sub||"",y=i?.tid||"";c?.spa_accountid&&r.account&&(r.account.nativeAccountId=c?.spa_accountid);const v=r.account?Ht(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:m,tenantId:y,scopes:g,account:v,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:d,fromCache:n,expiresOn:p,extExpiresOn:u,refreshOn:h,correlationId:o.correlationId,requestId:l||a.EMPTY_STRING,familyId:f,tokenType:r.accessToken?.tokenType||a.EMPTY_STRING,state:s?s.userRequestState:a.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||a.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||a.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}}}function bc(e,t,r,n,o,i,a,s,c,l,u){u?.verbose("setCachedAccount called");const h=e.getAccountKeys().find((e=>e.startsWith(r)));let d=null;h&&(d=e.getAccount(h));const g=d||Dt.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,n),p=g.tenantProfiles||[],f=s||g.realm;if(f&&!p.find((e=>e.tenantId===f))){const e=Bt(r,g.localAccountId,f,o);p.push(e)}return g.tenantProfiles=p,g}class wc{static validateRedirectUri(e){if(!e)throw Rt(st)}static validatePrompt(e){const t=[];for(const e in b)t.push(b[e]);if(t.indexOf(e)<0)throw Rt(gt)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw Rt(pt)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Rt(vt);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([w.PLAIN,w.S256].indexOf(e)<0)throw Rt(yt)}}async function kc(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class Cc extends pc{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(an,e.correlationId),!e.code)throw Be(ce);const r=je(),n=await Ba(this.executeTokenRequest.bind(this),sn,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[d],i=new vc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),Ba(i.handleServerTokenResponse.bind(i),hn,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw Rt(mt);const t=this.createLogoutUrlQueryString(e);return $t.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(sn,t.correlationId);const r=this.createTokenQueryParameters(t),n=$t.appendQueryString(e.tokenEndpoint,r),o=await Ba(this.createTokenRequestBody.bind(this),cn,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=Mt(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}.${e.utid}`,type:Es}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=Ya(this.config.authOptions.clientId,t);return Ba(this.executePostToTokenEndpoint.bind(this),Pr,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,Pr)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(cn,e.correlationId);const t=new Map;if(zs(t,e.embeddedClientId||e.tokenBodyParameters?.[Ps]||this.config.authOptions.clientId),this.includeRedirectUri?js(t,e.redirectUri):wc.validateRedirectUri(e.redirectUri),Us(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),Js(t,this.config.libraryInfo),Ys(t,this.config.telemetry.application),lc(t),this.serverTelemetryManager&&!hr(this.config)&&cc(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Zs(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;ec(t,await kc(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),tc(t,r.assertionType)}if(rc(t,"authorization_code"),nc(t),e.authenticationScheme===N.POP){const r=new mc(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Ba(r.generateCnf.bind(r),ln,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,ac(t,n)}else if(e.authenticationScheme===N.SSH){if(!e.sshJwk)throw Rt(Ct);sc(t,e.sshJwk)}let r;if((!Ot.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Qs(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Mt(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}.${t.utid}`,type:Es}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case Es:try{Gs(t,qt(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case _s:Ks(t,r.credential)}return e.embeddedClientId&&uc(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ic(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Ms]||ic(t,{[Ms]:"1"}),Fs(t,e.correlationId,this.performanceClient),jt(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Vs(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&Xs(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&ic(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&oc(t),jt(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class Ic{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||a.EMPTY_STRING,this.wrapperVer=e.wrapperVer||a.EMPTY_STRING,this.telemetryCacheKey=O.CACHE_KEY+I+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${O.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(O.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(O.VALUE_SEPARATOR);return[O.SCHEMA_VERSION,o,n].join(O.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Ic.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(O.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(O.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?O.OVERFLOW_TRUE:O.OVERFLOW_FALSE].join(O.VALUE_SEPARATOR);return[O.SCHEMA_VERSION,e.cacheHits,r,n,i].join(O.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=O.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof j?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(O.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Ic.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||a.EMPTY_STRING,i=e.failedRequests[2*t+1]||a.EMPTY_STRING,s=e.errors[t]||a.EMPTY_STRING;if(n+=o.toString().length+i.toString().length+s.length+3,!(n<O.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||a.EMPTY_STRING),e.push(this.regionSource||a.EMPTY_STRING),e.push(this.regionOutcome||a.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>"|"));return a.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}(e)}}class Sc{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||Yi(),this.logger=n.clone(Yn,ka,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Dt.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Dt.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return $t.getAbsoluteUrl(t,fa())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ic(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(xr,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace($t.getDomainFromUrl(o),t.environment):o,s=Fa.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Ba(hc,gn,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Rt(Et);return c}}async function Tc(e,t,r,n){r.addQueueMeasurement(Dr,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===N.SSH){if(!e.sshJwk)throw Rt(Ct);if(!e.sshKid)throw Rt(It)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=N.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Ot.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await aa(e.claims)),a}async function xc(e,t,r,n,o){n.addQueueMeasurement(Ur,e.correlationId);const i=await Ba(Tc,Dr,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class Ac extends Sc{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Yi(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=$t.getAbsoluteUrl(e.postLogoutRedirectUri,fa())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=$t.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,fa())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=$t.getAbsoluteUrl(fa(),fa())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Vr,this.correlationId);const t=await Ba(this.getClientConfiguration.bind(this),Jr,this.logger,this.performanceClient,this.correlationId)(e);return new Cc(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(Jr,this.correlationId);const s=await Ba(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Yn,version:ka,cpu:a.EMPTY_STRING,os:a.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Yr,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=fc.setRequestState(this.browserCrypto,e&&e.state||a.EMPTY_STRING,n),i={...await Ba(Tc,Dr,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||Yi(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return i;const s=e.account||this.browserStorage.getActiveAccount();return s&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${s.homeAccountId}`,this.correlationId),i.account=s),i}}const Ec="user_switch",_c={[Ec]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Pc extends j{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Pc.prototype),this.name="NativeAuthError",this.ext=r}}function Rc(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function Oc(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return Ja(za);case"USER_INTERACTION_REQUIRED":return new Qa(e,t);case"USER_CANCEL":return Ei(zo);case"NO_NETWORK":return Ei(oi)}return new Pc(e,_c[e]||t,r)}var Nc=r(64583).Promise;class Mc{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(xn)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Xn,extensionId:this.extensionId,responseId:Yi(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Nc(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new Mc(e,t,r,Zn);return await n.sendHandshakeRequest(),n}catch(n){const o=new Mc(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Xn,extensionId:this.extensionId,responseId:Yi(),body:{method:eo}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Nc(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(Ei(fi)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===Xn&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===eo){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Ei(mi))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if("Response"===e){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(Oc(e.code,e.description,e.ext));else{if(!e.result)throw $(D,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Oc(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===e){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case N.BEARER:case N.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}function qc(e,t,r){const n=zt(e);if(!n)throw Ut(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),Ei(Lo)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Ei(Mo));return n}function Lc(e,t,r,n){const o=jt(t,r,n);return $t.appendQueryString(e.authorizationEndpoint,o)}function Bc(e,t){if(!e.state||!t)throw e.state?Be(te,"Cached State"):Be(te,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw Be(Z,e.state)}try{n=decodeURIComponent(t)}catch(t){throw Be(Z,e.state)}if(r!==n)throw Be(ee);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(Va(e.error,e.error_description,e.suberror))throw new Qa(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new dc(e.error||"",e.error_description,e.suberror,t)}}class Hc{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(en,t.correlationId);try{r=function(e,t){if(Bc(e,t),!e.code)throw Be(xe);return e}(e,t.state)}catch(e){throw e instanceof dc&&e.subError===zo?Ei(zo):e}return Ba(this.handleCodeResponseFromServer.bind(this),Zr,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(Zr,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Ba(this.authModule.updateAuthority.bind(this.authModule),on,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Ba(this.authModule.acquireToken.bind(this.authModule),an,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Es}:e.loginHint?{credential:e.loginHint,type:_s}:null}}class Fc extends pc{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Br,e.correlationId);let t="0";if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Ot.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),Be(Ie);if(!e.account)throw Be(fe);const r=e.account.tenantId||function(e){const t=new $t(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case f:case m:case y:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!o)throw this.setCacheOutcome("2",e.correlationId),Be(Ie);if(i=o.cachedAt,Number(i)>je()||Ge(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome("3",e.correlationId),Be(Ie);var i;o.refreshOn&&Ge(o.refreshOn,0)&&(t="4");const a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Ba(this.generateResultFromCacheRecord.bind(this),Hr,this.logger,this.performanceClient,e.correlationId)(s,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Hr,t.correlationId),e.idToken&&(r=Ue(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw Be(ne);ze(e,t.maxAge)}return vc.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Dc extends Ac{async acquireToken(e){this.performanceClient.addQueueMeasurement(Cr,e.correlationId);const t=this.initializeServerTelemetryManager(61),r=await Ba(this.getClientConfiguration.bind(this),Jr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new Fc(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Ba(n.acquireCachedToken.bind(n),Br,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof Ai&&e.errorCode===li&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}var Uc=r(64583).Promise;class zc extends Sc{constructor(e,t,r,n,o,i,a,s,c,l,u,h){super(e,t,r,n,o,i,s,c,h),this.apiId=a,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new Dc(e,this.nativeStorageManager,r,n,o,i,s,c,h);const d=this.nativeMessageHandler.getExtensionId()===Zn?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Ic.makeExtraSkuString({libraryName:Yn,libraryVersion:ka,extensionName:d,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[qs]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Ar,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(Ar,e.correlationId),n=je(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(1===t)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=i,s={method:to,request:a},c=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(c);return await this.handleNativeResponse(l,i,n).then((e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e))).catch((e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(e){throw e instanceof Pc&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Nt.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Be(ve);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw Be(ve);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),o={method:to,request:n};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof Pc&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),Rc(e)))throw e}this.browserStorage.setTemporaryCache(go,JSON.stringify(n),!0);const i={apiId:vo,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(go));const i={method:to,request:o},a=je();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a),r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Uc.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=Ue(e.id_token,Li),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Oc(Ec);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=bc(this.browserStorage,a,o,Li,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return Dt.generateHomeAccountId(e.client_info||a.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Nt.fromString(e.scope):Nt.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===N.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new mc(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Be(_e);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,o,i){const s=this.addTelemetryFromNativeResponse(e),c=e.scope?Nt.fromString(e.scope):Nt.fromString(t.scope),l=e.account.properties||{},u=l.UID||r.oid||r.sub||a.EMPTY_STRING,h=l.TenantId||r.tid||a.EMPTY_STRING,d=Ht(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const g=await this.generatePopAccessToken(e,t),p=t.tokenType===N.POP?N.POP:N.BEARER;return{authority:o,uniqueId:u,tenantId:h,scopes:c.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:g,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:Ke(i+e.expires_in),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,r,n,o,i,s){const c=Qe(r,t.authority,e.id_token||"",t.clientId,n.tid||""),l=s+(t.tokenType===N.POP?a.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),u=this.generateScopes(e,t),h={idToken:c,accessToken:Ve(r,t.authority,o,t.clientId,n.tid||i,u.printScopes(),l,0,Li,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(h,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw $(D,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new $t(t);r.validateAsUri();const{scopes:n,...o}=e,i=new Nt(n||[]);i.appendScopes(s);const a={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),b.NONE}if(e.prompt)switch(e.prompt){case b.NONE:case b.CONSENT:case b.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),Ei(bi)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw Ei(ki);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===N.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new mc(this.browserCrypto);let n;if(a.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const o=await Ba(r.generateCnf.bind(r),ln,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,a.keyId=o.kid,a.signPopToken=!0}a.reqCnf=n}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Ls)&&e.extraParameters.hasOwnProperty(Bs)&&e.extraParameters.hasOwnProperty(Ps);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Bs],r=e.extraParameters[Ps]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}async function jc(e,t,r,n,o){const i=function(e,t,r,n){const o=t.correlationId,i=new Map;if(zs(i,t.embeddedClientId||t.extraQueryParameters?.[Ps]||e.clientId),Us(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),js(i,t.redirectUri),Vs(i,o),function(e,t){e.set("response_mode",t||"query")}(i,t.responseMode),nc(i),t.prompt&&(function(e,t){e.set("prompt",t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),t.prompt!==b.SELECT_ACCOUNT)if(t.sid&&t.prompt===b.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Ws(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),$s(i,s),n?.addFields({loginHintFromClaim:!0},o);try{Gs(i,qt(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===b.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Ws(i,e),n?.addFields({sidFromClaim:!0},o);try{Gs(i,qt(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),$s(i,t.loginHint),Ks(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),$s(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{Gs(i,qt(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),$s(i,t.loginHint),Ks(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&Xs(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Qs(i,t.claims,e.clientCapabilities),t.embeddedClientId&&uc(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Hs)||oc(i),i}({...e.auth,authority:t},r,n,o);if(Js(i,{sku:Yn,version:ka,os:"",cpu:""}),e.auth.protocolMode!==B&&Ys(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),r.authenticationScheme===N.POP)){const e=new Ma(n,o),t=new mc(e);let a;a=r.popKid?e.encodeKid(r.popKid):(await Ba(t.generateCnf.bind(t),ln,n,o,r.correlationId)(r,n)).reqCnfString,ac(i,a)}return Fs(i,r.correlationId,o),i}async function $c(e,t,r,n,o){if(!r.codeChallenge)throw Rt(vt);const i=await Ba(jc,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return Ds(i,"code"),function(e,t,r){if(!t||!r)throw Rt(vt);e.set("code_challenge",t),e.set("code_challenge_method",r)}(i,r.codeChallenge,a.S256_CODE_CHALLENGE_METHOD),ic(i,r.extraQueryParameters||{}),Lc(t,i,e.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function Kc(e,t,r,n,o,i){if(!n.earJwk)throw Ei(Po);const a=await jc(t,r,n,o,i);Ds(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk);const s=new Map;return ic(s,n.extraQueryParameters||{}),function(e,t,r){const n=e.createElement("form");return n.method="post",n.action=t,r.forEach(((t,r)=>{const o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)})),e.body.appendChild(n),n}(e,Lc(r,s,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)}async function Gc(e,t,r,n,o,i,a,s,c,l){if(!l)throw Ei(yi);const u=new Ma(s,c),h=new zc(n,o,u,s,a,n.system.navigationClient,r,c,l,t,i,e.correlationId),{userRequestState:d}=fc.parseRequestState(u,e.state);return Ba(h.acquireToken.bind(h),Ar,s,c,e.correlationId)({...e,state:d,prompt:void 0})}async function Wc(e,t,r,n,o,i,a,s,c,l,u,h){if(gc.removeThrottle(a,o.auth.clientId,e),t.accountId)return Ba(Gc,rn,l,u,e.correlationId)(e,t.accountId,n,o,a,s,c,l,u,h);const d={...e,code:t.code||"",codeVerifier:r},g=new Hc(i,a,d,l,u);return await Ba(g.handleCodeResponse.bind(g),en,l,u,e.correlationId)(t,e)}async function Qc(e,t,r,n,o,i,a,s,c,l,u){if(gc.removeThrottle(i,n.auth.clientId,e),Bc(t,e.state),!t.ear_jwe)throw Ei(Ro);if(!e.earJwk)throw Ei(Po);const h=JSON.parse(await Ba(ea,Kn,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(h.accountId)return Ba(Gc,rn,c,l,e.correlationId)(e,h.accountId,r,n,i,a,s,c,l,u);const d=new vc(n.auth.clientId,i,new Ma(c,l),c,null,null,l);d.validateTokenResponse(h);const g={code:"",state:e.state,nonce:e.nonce,client_info:h.client_info,cloud_graph_host_name:h.cloud_graph_host_name,cloud_instance_host_name:h.cloud_instance_host_name,cloud_instance_name:h.cloud_instance_name,msgraph_host:h.msgraph_host};return await Ba(d.handleServerTokenResponse.bind(d),hn,c,l,e.correlationId)(h,o,je(),e,g,void 0,void 0,void 0,void 0)}async function Vc(e,t,r){e.addQueueMeasurement(Nn,r);const n=La(Jc,Mn,t,e,r)(e,t,r);return{verifier:n,challenge:await Ba(Yc,qn,t,e,r)(n,e,t,r)}}function Jc(e,t,r){try{const n=new Uint8Array(32);return La(Vi,Bn,t,e,r)(n),Ni(n)}catch(e){throw Ei(_o)}}async function Yc(e,t,r,n){t.addQueueMeasurement(qn,n);try{const o=await Ba(Qi,Ln,r,t,n)(e,t,n);return Ni(new Uint8Array(o))}catch(e){throw Ei(_o)}}var Xc=r(64583).Promise;class Zc extends Ac{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||s,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return Xc.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return Xc.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");const n=await Ba(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,this.correlationId)(e,wo.Popup);t.popup&&wa(n.authority);const o=Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);return n.platformBroker=o,this.config.auth.protocolMode===H?this.executeEarFlow(n,t):this.executeCodeFlow(n,t,r)}async executeCodeFlow(e,t,r){const n=e.correlationId,o=this.initializeServerTelemetryManager(bo),i=r||await Ba(Vc,Nn,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a={...e,codeChallenge:i.challenge};try{const r=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,n)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=await Ba($c,Xr,this.logger,this.performanceClient,n)(this.config,r.authority,a,this.logger,this.performanceClient),c=this.initiateAuthRequest(s,t);this.eventHandler.emitEvent(bs,wo.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,t.popupWindowParent),u=La(qc,dn,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Ba(Wc,nn,this.logger,this.performanceClient,n)(e,u,i.verifier,bo,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}catch(e){throw t.popup?.close(),e instanceof j&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const r=e.correlationId,n=await Ba(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Ba(Zi,$n,this.logger,this.performanceClient,r)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await Kc(a.document,this.config,n,i,this.logger,this.performanceClient)).submit();const s=await Ba(this.monitorPopupForHash.bind(this),Gr,this.logger,this.performanceClient,r)(a,t.popupWindowParent),c=La(qc,dn,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Ba(Qc,tn,this.logger,this.performanceClient,r)(i,c,bo,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ws,wo.Popup,e);const o=this.initializeServerTelemetryManager(962);try{await this.clearCacheOnLogout(e.account);const i=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===B){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(ks,wo.Popup,e),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=$t.getAbsoluteUrl(n,fa());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const a=i.getLogoutUri(e);this.eventHandler.emitEvent(ks,wo.Popup,e);const s=this.openPopup(a,t);if(this.eventHandler.emitEvent(bs,wo.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch((()=>{})),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=$t.getAbsoluteUrl(n,fa());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof j&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.eventHandler.emitEvent(Cs,wo.Popup,null,e),this.eventHandler.emitEvent(Is,wo.Popup),e}this.eventHandler.emitEvent(Is,wo.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ei(No)}monitorPopupForHash(e,t){return new Xc(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(Ei(zo));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===k?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw Ei(Uo);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),Ei(Do)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,h=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=483),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=600),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-300+i)),(!h||h<0||h>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,a/2-241.5+o)),n.open(e,t,`width=${c}, height=${l}, top=${u}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${Jn}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${Jn}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class el extends Ac{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await Ba(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,this.correlationId)(e,wo.Redirect);t.platformBroker=Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);const r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent("msal:restoreFromBFCache",wo.Redirect))},n=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(so,n,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===H?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(e){throw e instanceof j&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const r=e.correlationId,n=this.initializeServerTelemetryManager(vo),o=await Ba(Vc,Nn,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{const r=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await Ba($c,Xr,this.logger,this.performanceClient,e.correlationId)(this.config,r.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}catch(e){throw e instanceof j&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,r=await Ba(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Ba(Zi,$n,this.logger,this.performanceClient,t)(),o={...e,earJwk:n};this.browserStorage.cacheAuthorizeRequest(o),(await Kc(document,this.config,r,o,this.logger,this.performanceClient)).submit()}async handleRedirectPromise(e="",t,r,n){const o=this.initializeServerTelemetryManager(865);try{const[i,s]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const c=this.browserStorage.getTemporaryCache(so,!0)||a.EMPTY_STRING;if($t.removeHashFromUrl(c)===$t.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),c.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(c),await this.handleResponse(i,t,r,o);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,r,o);if(!pa()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(co,s,!0);const e={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let n=!0;if(c&&"null"!==c)this.logger.verbose(`Navigating to loginRequestUrl: ${c}`),n=await this.navigationClient.navigateInternal(c,e);else{const t=function(){const e=new $t(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(so,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),n=await this.navigationClient.navigateInternal(t,e)}if(!n)return await this.handleResponse(i,t,r,o)}return null}catch(e){throw e instanceof j&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===k?window.location.search:window.location.hash);let r=zt(t);if(r){try{!function(e,t,r){if(!e.state)throw Ei(qo);const n=function(e,t){if(!t)return null;try{return fc.parseRequestState(e,t).libraryState.meta}catch(e){throw Be(Z)}}(t,e.state);if(!n)throw Ei(Bo);if(n.interactionType!==r)throw Ei(Ho)}(r,this.browserCrypto,wo.Redirect)}catch(e){return e instanceof j&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return ga(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const n=this.browserStorage.getTemporaryCache(co,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(co)),n&&(r=zt(n),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}async handleResponse(e,t,r,n){if(!e.state)throw Ei(qo);if(e.ear_jwe){const r=await Ba(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Ba(Qc,tn,this.logger,this.performanceClient,t.correlationId)(t,e,vo,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}const o=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return Ba(Wc,nn,this.logger,this.performanceClient,t.correlationId)(t,e,r,vo,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:vo,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=t||this.config.auth.onRedirectNavigate;return"function"==typeof n?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==n(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,r))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ei(No)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(961);try{this.eventHandler.emitEvent(ws,wo.Redirect,e),await this.clearCacheOnLogout(t.account);const n={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===B)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(ks,wo.Redirect,t)}const i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(ks,wo.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,ao),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,ao),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof j&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(Cs,wo.Redirect,null,e),this.eventHandler.emitEvent(Is,wo.Redirect),e}this.eventHandler.emitEvent(Is,wo.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return $t.getAbsoluteUrl(t,fa())}}var tl=r(64583).Promise;async function rl(e,t,r,n,o){if(t.addQueueMeasurement(Kr,n),!e)throw r.info("Navigate url is empty"),Ei(No);return o?Ba(il,Wr,r,t,n)(e,o,t,n):La(al,Qr,r,t,n)(e)}async function nl(e,t,r,n,o){const i=sl();if(!i.contentDocument)throw"No document associated with iframe!";return(await Kc(i.contentDocument,e,t,r,n,o)).submit(),i}async function ol(e,t,r,n,o,i,a){return n.addQueueMeasurement(Gr,i),new tl(((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(Ei($o))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===k?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)}),r)})).finally((()=>{La(cl,An,o,n,i)(e)}))}function il(e,t,r,n){return r.addQueueMeasurement(Wr,n),new tl(((r,n)=>{const o=sl();window.setTimeout((()=>{o?(o.src=e,r(o)):n("Unable to load iframe")}),t)}))}function al(e){const t=sl();return t.src=e,t}function sl(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function cl(e){document.body===e.parentNode&&document.body.removeChild(e)}var ll=r(64583).Promise;class ul extends Ac{constructor(e,t,r,n,o,i,a,s,c,l,u){super(e,t,r,n,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Ir,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==b.NONE&&t.prompt!==b.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${b.NONE}`),t.prompt=b.NONE):t.prompt=b.NONE;const r=await Ba(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,e.correlationId)(t,wo.Silent);return r.platformBroker=Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme),wa(r.authority),this.config.auth.protocolMode===H?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const r=this.initializeServerTelemetryManager(this.apiId);try{return t=await Ba(this.createAuthCodeClient.bind(this),Vr,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Ba(this.silentTokenHelper.bind(this),$r,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(n){if(n instanceof j&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),!(t&&n instanceof j&&n.errorCode===Vn))throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await Ba(this.silentTokenHelper.bind(this),$r,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,r=await Ba(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await Ba(Zi,$n,this.logger,this.performanceClient,t)(),o={...e,earJwk:n},i=await Ba(nl,Kr,this.logger,this.performanceClient,t)(this.config,r,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await Ba(ol,Gr,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=La(qc,dn,this.logger,this.performanceClient,t)(s,a,this.logger);return Ba(Qc,tn,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}logout(){return ll.reject(Ei(Vo))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement($r,r);const n=await Ba(Vc,Nn,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),o={...t,codeChallenge:n.challenge},i=await Ba($c,Xr,this.logger,this.performanceClient,r)(this.config,e.authority,o,this.logger,this.performanceClient),a=await Ba(rl,Kr,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await Ba(ol,Gr,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=La(qc,dn,this.logger,this.performanceClient,r)(c,s,this.logger);return Ba(Wc,nn,this.logger,this.performanceClient,r)(t,l,n.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}}class hl extends pc{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Or,e.correlationId);const t=je(),r=await Ba(this.executeTokenRequest.bind(this),Rr,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[d],o=new vc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),Ba(o.handleServerTokenResponse.bind(o),hn,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw Rt(ft);if(this.performanceClient?.addQueueMeasurement(Mr,e.correlationId),!e.account)throw Be(fe);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Ba(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof Qa&&t.errorCode===Ua,n=t instanceof dc&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return Ba(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Ba(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Nr,e.correlationId);const r=La(this.cacheManager.getRefreshToken.bind(this.cacheManager),_n,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw Ja(Ua);if(r.expiresOn&&Ge(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),Ja(ja);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||N.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Es}};try{return await Ba(this.acquireToken.bind(this),Or,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof Qa&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===$a)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=We(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Rr,e.correlationId);const r=this.createTokenQueryParameters(e),n=$t.appendQueryString(t.tokenEndpoint,r),o=await Ba(this.createTokenRequestBody.bind(this),qr,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=Ya(this.config.authOptions.clientId,e);return Ba(this.executePostToTokenEndpoint.bind(this),_r,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,_r)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(qr,e.correlationId);const t=new Map;if(zs(t,e.embeddedClientId||e.tokenBodyParameters?.[Ps]||this.config.authOptions.clientId),e.redirectUri&&js(t,e.redirectUri),Us(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),rc(t,"refresh_token"),nc(t),Js(t,this.config.libraryInfo),Ys(t,this.config.telemetry.application),lc(t),this.serverTelemetryManager&&!hr(this.config)&&cc(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Zs(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;ec(t,await kc(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),tc(t,r.assertionType)}if(e.authenticationScheme===N.POP){const r=new mc(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await Ba(r.generateCnf.bind(r),ln,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,ac(t,n)}else if(e.authenticationScheme===N.SSH){if(!e.sshJwk)throw Rt(Ct);sc(t,e.sshJwk)}if((!Ot.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Qs(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Es:try{Gs(t,qt(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case _s:Ks(t,e.ccsCredential.credential)}return e.embeddedClientId&&uc(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ic(t,e.tokenBodyParameters),Fs(t,e.correlationId,this.performanceClient),jt(t)}}var dl=r(64583).Promise;class gl extends Ac{async acquireToken(e){this.performanceClient.addQueueMeasurement(Sr,e.correlationId);const t=await Ba(Tc,Dr,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(61),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return Ba(o.acquireTokenByRefreshToken.bind(o),Mr,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return dl.reject(Ei(Vo))}async createRefreshTokenClient(e){const t=await Ba(this.getClientConfiguration.bind(this),Jr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new hl(t,this.performanceClient)}}class pl{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw Ei(ri);const n=e.correlationId||Yi(),o=t.id_token?Ue(t.id_token,Li):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Fa(Fa.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Yi()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Dt.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ei(ci);const i=Dt.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=bc(this.storage,o,i,Li,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Qe(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Nt.fromString(t.scope):new Nt(e.scopes),c=i.expiresOn||t.expires_in+je(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+je(),u=Ve(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,Li);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=Je(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=Nt.fromString(t.accessToken.target).asArray(),s=Ke(t.accessToken.expiresOn),o=Ke(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class fl extends Cc{constructor(e){super(e),this.includeRedirectUri=!1}}var ml=r(64583).Promise;class yl extends Ac{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw Ei(ui);const t=await Ba(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,e.correlationId)(e,wo.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},o=await Ba(this.getClientConfiguration.bind(this),Jr,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new fl(o);this.logger.verbose("Auth code client created");const a=new Hc(i,this.browserStorage,n,this.logger,this.performanceClient);return await Ba(a.handleCodeResponseFromServer.bind(a),Zr,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof j&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return ml.reject(Ei(Vo))}}var vl=r(64583).Promise;function bl(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function wl(e,t){try{va(e)}catch(e){throw t.end({success:!1},e),e}}class kl{constructor(e){var t,r,n,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ma(this.logger,this.performanceClient):He,this.eventHandler=new As(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ts(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw Rt(bt)}return{canonicalAuthority:e.authority?Da(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):(t=this.config.auth.clientId,r=this.logger,n=this.performanceClient,o=this.eventHandler,new Ts(t,{cacheLocation:oo,temporaryCacheLocation:oo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},He,r,n,o));const i={cacheLocation:oo,temporaryCacheLocation:oo,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ts(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new pl(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new kl(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(ss);const r=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(zr,r);if(this.eventHandler.emitEvent("msal:initializeStart"),!t)try{this.logMultipleInstances(o)}catch{}if(await Ba(this.browserStorage.initialize.bind(this.browserStorage),jr,this.logger,this.performanceClient,r)(r),n)try{this.nativeExtensionProvider=await Mc.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await Ba(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),En,this.logger,this.performanceClient,r)(this.performanceClient,r)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r),this.initialized=!0,this.eventHandler.emitEvent(ss),o.end({allowPlatformBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),ya(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getInteractionInProgress()?.type;if(t===ao)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),vl.resolve(null);const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e;let i,a;this.eventHandler.emitEvent("msal:handleRedirectStart",wo.Redirect);try{if(o&&this.nativeExtensionProvider){i=this.performanceClient.startMeasurement(br,n?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=Ba(e.handleRedirectPromise.bind(e),Tn,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,r]=this.browserStorage.getCachedRequest(),n=t.correlationId;i=this.performanceClient.startMeasurement(br,n),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(n);a=Ba(o.handleRedirectPromise.bind(o),Sn,this.logger,this.performanceClient,i.event.correlationId)(e,t,r,i)}}catch(e){throw this.browserStorage.resetRequestCache(),e}return a.then((e=>(e?(this.browserStorage.resetRequestCache(),r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ds,wo.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(fs,wo.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:bl(e.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),this.eventHandler.emitEvent(vs,wo.Redirect),e))).catch((e=>{this.browserStorage.resetRequestCache();const t=e;throw r.length>0?this.eventHandler.emitEvent(ms,wo.Redirect,null,t):this.eventHandler.emitEvent(gs,wo.Redirect,null,t),this.eventHandler.emitEvent(vs,wo.Redirect),i.end({success:!1},t),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement("acquireTokenPreRedirect",t);r.add({accountType:bl(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const o=this.getAllAccounts().length>0;try{let n;return ba(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,io),o?this.eventHandler.emitEvent(ps,wo.Redirect,e):this.eventHandler.emitEvent(hs,wo.Redirect,e),n=this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?new zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,vo,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch((r=>{if(r instanceof Pc&&Rc(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof Qa)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw r})):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw this.browserStorage.resetRequestCache(),r.end({success:!1},e),o?this.eventHandler.emitEvent(ms,wo.Redirect,null,e):this.eventHandler.emitEvent(gs,wo.Redirect,null,e),e}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(vr,t);r.add({scenarioId:e.scenarioId,accountType:bl(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),wl(this.initialized,r),this.browserStorage.setInteractionInProgress(!0,io)}catch(e){return vl.reject(e)}const n=this.getAllAccounts();let o;n.length>0?this.eventHandler.emitEvent(ps,wo.Popup,e):this.eventHandler.emitEvent(hs,wo.Popup,e);const i=this.getPreGeneratedPkceCodes(t);return o=this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},bo).then((e=>(r.end({success:!0,isNativeBroker:!0,accountType:bl(e.account)}),e))).catch((r=>{if(r instanceof Pc&&Rc(r))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,i);if(r instanceof Qa)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,i);throw r})):this.createPopupClient(t).acquireToken(e,i),o.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ds,wo.Popup,e):this.eventHandler.emitEvent(fs,wo.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:bl(e.account)}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(ms,wo.Popup,null,e):this.eventHandler.emitEvent(gs,wo.Popup,null,e),r.end({success:!1},e),vl.reject(e)))).finally((async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)}))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Tr,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:bl(e.account)}),wl(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",wo.Silent,r),n=this.canUsePlatformBroker(r)?this.acquireTokenNative(r,863).catch((e=>{if(e instanceof Pc&&Rc(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e})):this.createSilentIframeClient(r.correlationId).acquireToken(r),n.then((e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",wo.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:bl(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",wo.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(pr,t);wl(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",wo.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ei(di);if(e.code){const n=e.code;let o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",wo.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:bl(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(ys,wo.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},866,e.nativeAccountId).catch((e=>{throw e instanceof Pc&&Rc(e)&&(this.nativeExtensionProvider=void 0),e}));return r.end({accountType:bl(n.account),success:!0}),n}throw Ei(pi)}throw Ei(hi)}catch(e){throw this.eventHandler.emitEvent(ys,wo.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(In,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Lr,e.correlationId),t){case 0:case 1:case 2:const t=this.createSilentCacheClient(e.correlationId);return Ba(t.acquireToken.bind(t),Cr,this.logger,this.performanceClient,e.correlationId)(e);default:throw Be(Ie)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(fr,e.correlationId),t){case 0:case 2:case 3:case 4:const t=this.createSilentRefreshClient(e.correlationId);return Ba(t.acquireToken.bind(t),Sr,this.logger,this.performanceClient,e.correlationId)(e);default:throw Be(Ie)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Fr,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Ba(t.acquireToken.bind(t),Ir,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return ba(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,ao),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return va(this.initialized),this.browserStorage.setInteractionInProgress(!0,ao),this.createPopupClient(t).logout(e).finally((()=>{this.browserStorage.setInteractionInProgress(!1)}))}catch(e){return vl.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return function(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return function(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByUsername(e){return function(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return function(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return function(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage)}setActiveAccount(e){!function(e,t){t.setActiveAccount(e)}(e,this.browserStorage)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Dt.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Ei(yi);return new zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case b.NONE:case b.CONSENT:case b.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new el(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new ul(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Dc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new gl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new yl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return ma(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===ro?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===ro?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Yi():a.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||ko})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||ko})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(mr,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),wl(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw Ei(Jo);return r.add({accountType:bl(n)}),this.acquireTokenSilentDeduped(e,n,t).then((n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t}))).catch((e=>{throw e instanceof j&&e.setCorrelationId(t),r.end({success:!1},e),e}))}async acquireTokenSilentDeduped(e,t,r){const n=Ya(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=Ba(this.acquireTokenSilentAsync.bind(this),yr,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally((()=>{this.activeSilentTokenRequests.delete(o)}))}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(yr,e.correlationId),this.eventHandler.emitEvent(ps,wo.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await Ba(xc,Ur,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||0;return this.acquireTokenSilentNoIframe(n,o).catch((async e=>{const t=function(e,t){const r=!(e instanceof Qa&&e.subError!==$a),n=e.errorCode===Vn||e.errorCode===Ie,o=r&&n||e.errorCode===Ua||e.errorCode===ja,i=So.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(5!==o){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement("awaitConcurrentIframe",n.correlationId);i.add({awaitIframeCorrelationId:r});const a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),Ba(this.acquireTokenBySilentIframe.bind(this),Fr,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new vl((t=>{e=t})),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),Ba(this.acquireTokenBySilentIframe.bind(this),Fr,this.logger,this.performanceClient,n.correlationId)(n).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(fs,wo.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(ms,wo.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",r)}))}async acquireTokenSilentNoIframe(e,t){return Mc.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch((async e=>{if(e instanceof Pc&&Rc(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,Be(Ie);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Ba(this.acquireTokenFromCache.bind(this),Lr,this.logger,this.performanceClient,e.correlationId)(e,t).catch((r=>{if(1===t)throw r;return this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",wo.Silent,e),Ba(this.acquireTokenByRefreshToken.bind(this),fr,this.logger,this.performanceClient,e.correlationId)(e,t)})))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Ba(Vc,Nn,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),vl.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,r){const n=window.msal?.clientIds||[],o=n.length,i=n.filter((t=>t===e)).length;i>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(t,e,this.logger))}}r(64583).Promise;class Cl{static async createPublicClientApplication(e){const t=await async function(e){const t=new Ia(e);return await t.initialize(),kl.createController(t,void 0)}(e);return new Cl(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new kl(new Ia(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var Il={auth:{clientId:"fd4d6a28-4f7b-4356-af5a-452ec92c7e81",authority:"https://login.microsoftonline.com/organizations",redirectUri:"https://localhost:3000",navigateToLoginRequestUrl:!0},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0},system:{loggerOptions:{loggerCallback:function(e,t,r){if(!r)switch(e){case 0:return void console.error(t);case 1:return void console.warn(t);case 2:return void console.info(t);case 3:return void console.debug(t);default:return}}}}},Sl={scopes:["openid","profile","User.Read"]},Tl={scopes:["User.Read"]},xl=r(64583).Promise;function Al(e){return Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Al(e)}function El(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?El(Object(r),!0).forEach((function(t){Pl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):El(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pl(e,t,r){return(t=function(e){var t=function(e){if("object"!=Al(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Al(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Al(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rl(){Rl=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Al(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Al(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=xl);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Ol(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):xl.resolve(c).then(n,o)}function Nl(e){return function(){var t=this,r=arguments;return new xl((function(n,o){var i=e.apply(t,r);function a(e){Ol(i,n,o,a,s,"next",e)}function s(e){Ol(i,n,o,a,s,"throw",e)}a(void 0)}))}}var Ml=new Cl(Il),ql=!1;function Ll(){return Bl.apply(this,arguments)}function Bl(){return(Bl=Nl(Rl().mark((function e(){var t;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ql){e.next=16;break}return e.prev=1,e.next=4,Ml.initialize();case 4:return ql=!0,console.log("MSAL instance initialized successfully"),e.next=8,Ml.handleRedirectPromise();case 8:(t=e.sent)&&console.log("Redirect response:",t),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),console.error("MSAL Initialization Error:",e.t0),e.t0;case 16:return e.abrupt("return",Ml);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}var Hl,Fl,Dl,Ul,zl,jl,$l={getAccount:(jl=Nl(Rl().mark((function e(){var t;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ll();case 3:return e.next=5,Ml.getAllAccounts();case 5:return t=e.sent,e.abrupt("return",(null==t?void 0:t[0])||null);case 9:return e.prev=9,e.t0=e.catch(0),console.error("Error getting account:",e.t0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),function(){return jl.apply(this,arguments)}),getToken:(zl=Nl(Rl().mark((function e(){var t,r;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ll();case 3:return e.next=5,$l.getAccount();case 5:if(t=e.sent){e.next=8;break}throw new Error("No account found");case 8:return e.next=10,Ml.acquireTokenSilent(_l(_l({},Tl),{},{account:t}));case 10:return r=e.sent,e.abrupt("return",r.accessToken);case 14:throw e.prev=14,e.t0=e.catch(0),console.error("Error getting token:",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),function(){return zl.apply(this,arguments)}),login:(Ul=Nl(Rl().mark((function e(){var t,r,n=arguments;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"redirect",e.prev=1,e.next=4,Ll();case 4:if(console.log("Starting Microsoft login with method: ".concat(t)),"popup"!==t){e.next=13;break}return e.next=8,Ml.loginPopup(Sl);case 8:return r=e.sent,console.log("Login popup successful:",r),e.abrupt("return",r);case 13:return e.next=15,Ml.loginRedirect(Sl);case 15:console.log("Login redirect initiated");case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(1),console.error("Login failed:",e.t0),new Error("Microsoft login failed: ".concat(e.t0.message));case 22:case"end":return e.stop()}}),e,null,[[1,18]])}))),function(){return Ul.apply(this,arguments)}),logoutRedirect:(Dl=Nl(Rl().mark((function e(){var t,r;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ll();case 3:return e.next=5,$l.getAccount();case 5:if(!(t=e.sent)){e.next=15;break}return console.log("Logging out account:",t.username),r={account:t,postLogoutRedirectUri:window.location.origin},e.next=11,Ml.clearCache();case 11:return e.next=13,Ml.logoutRedirect(r);case 13:e.next=16;break;case 15:console.log("No account to logout");case 16:e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),console.error("Logout failed:",e.t0),new Error("Microsoft logout failed: ".concat(e.t0.message));case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),function(){return Dl.apply(this,arguments)}),isAuthenticated:(Fl=Nl(Rl().mark((function e(){var t;return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$l.getAccount();case 3:return t=e.sent,e.abrupt("return",!!t);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error checking authentication:",e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return Fl.apply(this,arguments)}),getMsalInstance:(Hl=Nl(Rl().mark((function e(){return Rl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ll();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return Hl.apply(this,arguments)})},Kl=$l,Gl=r(64583).Promise;function Wl(e){return Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wl(e)}function Ql(){Ql=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Wl(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Wl(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Gl);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Vl(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Gl.resolve(c).then(n,o)}function Jl(e){return function(){var t=this,r=arguments;return new Gl((function(n,o){var i=e.apply(t,r);function a(e){Vl(i,n,o,a,s,"next",e)}function s(e){Vl(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Yl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Zl=(0,n.createContext)(),eu=function(e){var t=e.children,r=Yl((0,n.useState)(null),2),o=r[0],i=r[1],a=Yl((0,n.useState)(!0),2),s=a[0],c=a[1],l=Yl((0,n.useState)(null),2),u=l[0],h=l[1],d=Yl((0,n.useState)(!1),2),g=d[0],p=d[1],f=function(e){try{var t;"undefined"!=typeof Office&&null!==(t=Office)&&void 0!==t&&null!==(t=t.context)&&void 0!==t&&null!==(t=t.document)&&void 0!==t&&t.settings&&(Office.context.document.settings.set("isLoggedIn",e),Office.context.document.settings.saveAsync()),e?localStorage.setItem("isLoggedIn","true"):localStorage.removeItem("isLoggedIn")}catch(e){console.error("Error updating Office settings:",e)}},m=function(){var e=Jl(Ql().mark((function e(){var t,r,n;return Ql().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),h(null),e.prev=2,console.log("Starting Microsoft login..."),e.next=6,Kl.login("popup");case 6:return e.next=8,Kl.getAccount();case 8:if(!(t=e.sent)){e.next=18;break}return console.log("Account obtained, getting token..."),e.next=13,Kl.getToken();case 13:r=e.sent,console.log("Microsoft token obtained, calling backend...",r),r&&(f(!0),i({accessToken:r,user:{name:t.name,email:t.username},isFirstLogin:!localStorage.getItem("isLoggedIn")})),e.next=19;break;case 18:throw new Error("No account found after login");case 19:e.next=27;break;case 21:throw e.prev=21,e.t0=e.catch(2),console.error("Microsoft login failed:",e.t0),n=e.t0 instanceof Error?e.t0.message:"Microsoft login failed. Please try again.",h(n),e.t0;case 27:return e.prev=27,p(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[2,21,27,30]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Jl(Ql().mark((function e(){return Ql().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(null),localStorage.clear(),sessionStorage.clear(),f(!1),e.next=7,Kl.logoutRedirect();case 7:if("undefined"==typeof Office||!Office.context||void 0===Office.context.auth){e.next=16;break}return e.prev=8,e.next=11,Office.context.auth.clearClientCredentials();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.warn("Could not clear Office credentials:",e.t0);case 16:e.next=22;break;case 18:throw e.prev=18,e.t1=e.catch(0),console.error("Microsoft logout failed:",e.t1),e.t1;case 22:case"end":return e.stop()}}),e,null,[[0,18],[8,13]])})));return function(){return e.apply(this,arguments)}}();(0,n.useEffect)((function(){s&&o&&(o.user&&localStorage.setItem("user",JSON.stringify(o.user)),localStorage.setItem("isFirstLogin",String(o.isFirstLogin)))}),[o,s]);var v={auth:o,setAuth:i,isPersist:s,setIsPersist:c,loginWithMicrosoft:m,logoutWithMicrosoft:y,microsoftAuthError:u,setMicrosoftAuthError:h,isLoggingIn:g};return n.createElement(Zl.Provider,{value:v},t)},tu=function(){var e=(0,n.useContext)(Zl);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};const ru=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,((e,t,r)=>r?r.toUpperCase():t.toLowerCase())))(e);return t.charAt(0).toUpperCase()+t.slice(1)},nu=(...e)=>e.filter(((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t)).join(" ").trim(),ou=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var iu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const au=(0,n.forwardRef)((({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:i="",children:a,iconNode:s,...c},l)=>(0,n.createElement)("svg",{ref:l,...iu,width:t,height:t,stroke:e,strokeWidth:o?24*Number(r)/Number(t):r,className:nu("lucide",i),...!a&&!ou(c)&&{"aria-hidden":"true"},...c},[...s.map((([e,t])=>(0,n.createElement)(e,t))),...Array.isArray(a)?a:[a]]))),su=(e,t)=>{const r=(0,n.forwardRef)((({className:r,...o},i)=>{return(0,n.createElement)(au,{ref:i,iconNode:t,className:nu(`lucide-${a=ru(e),a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...o});var a}));return r.displayName=ru(e),r},cu=su("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function lu(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=lu(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function uu(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=lu(e))&&(n&&(n+=" "),n+=t);return n}const hu=e=>{const t=fu(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:e=>{const r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),du(r,t)||pu(e)},getConflictingClassGroupIds:(e,t)=>{const o=r[e]||[];return t&&n[e]?[...o,...n[e]]:o}}},du=(e,t)=>{if(0===e.length)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),o=n?du(e.slice(1),n):void 0;if(o)return o;if(0===t.validators.length)return;const i=e.join("-");return t.validators.find((({validator:e})=>e(i)))?.classGroupId},gu=/^\[(.+)\]$/,pu=e=>{if(gu.test(e)){const t=gu.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},fu=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const e in r)mu(r[e],n,e,t);return n},mu=(e,t,r,n)=>{e.forEach((e=>{if("string"!=typeof e){if("function"==typeof e)return vu(e)?void mu(e(n),t,r,n):void t.validators.push({validator:e,classGroupId:r});Object.entries(e).forEach((([e,o])=>{mu(o,yu(t,e),r,n)}))}else(""===e?t:yu(t,e)).classGroupId=r}))},yu=(e,t)=>{let r=e;return t.split("-").forEach((e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)})),r},vu=e=>e.isThemeGetter,bu=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const o=(o,i)=>{r.set(o,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=n.get(e))?(o(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):o(e,t)}}},wu=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=e=>{const t=[];let r,n=0,o=0,i=0;for(let a=0;a<e.length;a++){let s=e[a];if(0===n&&0===o){if(":"===s){t.push(e.slice(i,a)),i=a+1;continue}if("/"===s){r=a;continue}}"["===s?n++:"]"===s?n--:"("===s?o++:")"===s&&o--}const a=0===t.length?e:e.substring(i),s=ku(a);return{modifiers:t,hasImportantModifier:s!==a,baseClassName:s,maybePostfixModifierPosition:r&&r>i?r-i:void 0}};if(t){const e=t+":",r=n;n=t=>t.startsWith(e)?r(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(r){const e=n;n=t=>r({className:t,parseClassName:e})}return n},ku=e=>e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e,Cu=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map((e=>[e,!0])));return e=>{if(e.length<=1)return e;const r=[];let n=[];return e.forEach((e=>{"["===e[0]||t[e]?(r.push(...n.sort(),e),n=[]):n.push(e)})),r.push(...n.sort()),r}},Iu=/\s+/;function Su(){let e,t,r=0,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Tu(e))&&(n&&(n+=" "),n+=t);return n}const Tu=e=>{if("string"==typeof e)return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Tu(e[n]))&&(r&&(r+=" "),r+=t);return r};function xu(e,...t){let r,n,o,i=function(s){const c=t.reduce(((e,t)=>t(e)),e());return r=(e=>({cache:bu(e.cacheSize),parseClassName:wu(e),sortModifiers:Cu(e),...hu(e)}))(c),n=r.cache.get,o=r.cache.set,i=a,a(s)};function a(e){const t=n(e);if(t)return t;const i=((e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o,sortModifiers:i}=t,a=[],s=e.trim().split(Iu);let c="";for(let e=s.length-1;e>=0;e-=1){const t=s[e],{isExternal:l,modifiers:u,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:g}=r(t);if(l){c=t+(c.length>0?" "+c:c);continue}let p=!!g,f=n(p?d.substring(0,g):d);if(!f){if(!p){c=t+(c.length>0?" "+c:c);continue}if(f=n(d),!f){c=t+(c.length>0?" "+c:c);continue}p=!1}const m=i(u).join(":"),y=h?m+"!":m,v=y+f;if(a.includes(v))continue;a.push(v);const b=o(f,p);for(let e=0;e<b.length;++e){const t=b[e];a.push(y+t)}c=t+(c.length>0?" "+c:c)}return c})(e,r);return o(e,i),i}return function(){return i(Su.apply(null,arguments))}}const Au=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},Eu=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_u=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Pu=/^\d+\/\d+$/,Ru=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ou=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Nu=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Mu=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qu=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Lu=e=>Pu.test(e),Bu=e=>!!e&&!Number.isNaN(Number(e)),Hu=e=>!!e&&Number.isInteger(Number(e)),Fu=e=>e.endsWith("%")&&Bu(e.slice(0,-1)),Du=e=>Ru.test(e),Uu=()=>!0,zu=e=>Ou.test(e)&&!Nu.test(e),ju=()=>!1,$u=e=>Mu.test(e),Ku=e=>qu.test(e),Gu=e=>!Qu(e)&&!eh(e),Wu=e=>sh(e,hh,ju),Qu=e=>Eu.test(e),Vu=e=>sh(e,dh,zu),Ju=e=>sh(e,gh,Bu),Yu=e=>sh(e,lh,ju),Xu=e=>sh(e,uh,Ku),Zu=e=>sh(e,fh,$u),eh=e=>_u.test(e),th=e=>ch(e,dh),rh=e=>ch(e,ph),nh=e=>ch(e,lh),oh=e=>ch(e,hh),ih=e=>ch(e,uh),ah=e=>ch(e,fh,!0),sh=(e,t,r)=>{const n=Eu.exec(e);return!!n&&(n[1]?t(n[1]):r(n[2]))},ch=(e,t,r=!1)=>{const n=_u.exec(e);return!!n&&(n[1]?t(n[1]):r)},lh=e=>"position"===e||"percentage"===e,uh=e=>"image"===e||"url"===e,hh=e=>"length"===e||"size"===e||"bg-size"===e,dh=e=>"length"===e,gh=e=>"number"===e,ph=e=>"family-name"===e,fh=e=>"shadow"===e,mh=xu((Symbol.toStringTag,()=>{const e=Au("color"),t=Au("font"),r=Au("text"),n=Au("font-weight"),o=Au("tracking"),i=Au("leading"),a=Au("breakpoint"),s=Au("container"),c=Au("spacing"),l=Au("radius"),u=Au("shadow"),h=Au("inset-shadow"),d=Au("text-shadow"),g=Au("drop-shadow"),p=Au("blur"),f=Au("perspective"),m=Au("aspect"),y=Au("ease"),v=Au("animate"),b=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",eh,Qu],w=()=>[eh,Qu,c],k=()=>[Lu,"full","auto",...w()],C=()=>[Hu,"none","subgrid",eh,Qu],I=()=>["auto",{span:["full",Hu,eh,Qu]},Hu,eh,Qu],S=()=>[Hu,"auto",eh,Qu],T=()=>["auto","min","max","fr",eh,Qu],x=()=>["auto",...w()],A=()=>[Lu,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...w()],E=()=>[e,eh,Qu],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",nh,Yu,{position:[eh,Qu]}],P=()=>["auto","cover","contain",oh,Wu,{size:[eh,Qu]}],R=()=>[Fu,th,Vu],O=()=>["","none","full",l,eh,Qu],N=()=>["",Bu,th,Vu],M=()=>[Bu,Fu,nh,Yu],q=()=>["","none",p,eh,Qu],L=()=>["none",Bu,eh,Qu],B=()=>["none",Bu,eh,Qu],H=()=>[Bu,eh,Qu],F=()=>[Lu,"full",...w()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Du],breakpoint:[Du],color:[Uu],container:[Du],"drop-shadow":[Du],ease:["in","out","in-out"],font:[Gu],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Du],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Du],shadow:[Du],spacing:["px",Bu],text:[Du],"text-shadow":[Du],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Lu,Qu,eh,m]}],container:["container"],columns:[{columns:[Bu,Qu,eh,s]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:b()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:k()}],"inset-x":[{"inset-x":k()}],"inset-y":[{"inset-y":k()}],start:[{start:k()}],end:[{end:k()}],top:[{top:k()}],right:[{right:k()}],bottom:[{bottom:k()}],left:[{left:k()}],visibility:["visible","invisible","collapse"],z:[{z:[Hu,"auto",eh,Qu]}],basis:[{basis:[Lu,"full","auto",s,...w()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Bu,Lu,"auto","initial","none",Qu]}],grow:[{grow:["",Bu,eh,Qu]}],shrink:[{shrink:["",Bu,eh,Qu]}],order:[{order:[Hu,"first","last","none",eh,Qu]}],"grid-cols":[{"grid-cols":C()}],"col-start-end":[{col:I()}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":C()}],"row-start-end":[{row:I()}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":T()}],"auto-rows":[{"auto-rows":T()}],gap:[{gap:w()}],"gap-x":[{"gap-x":w()}],"gap-y":[{"gap-y":w()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:w()}],px:[{px:w()}],py:[{py:w()}],ps:[{ps:w()}],pe:[{pe:w()}],pt:[{pt:w()}],pr:[{pr:w()}],pb:[{pb:w()}],pl:[{pl:w()}],m:[{m:x()}],mx:[{mx:x()}],my:[{my:x()}],ms:[{ms:x()}],me:[{me:x()}],mt:[{mt:x()}],mr:[{mr:x()}],mb:[{mb:x()}],ml:[{ml:x()}],"space-x":[{"space-x":w()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":w()}],"space-y-reverse":["space-y-reverse"],size:[{size:A()}],w:[{w:[s,"screen",...A()]}],"min-w":[{"min-w":[s,"screen","none",...A()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]},...A()]}],h:[{h:["screen","lh",...A()]}],"min-h":[{"min-h":["screen","lh","none",...A()]}],"max-h":[{"max-h":["screen","lh",...A()]}],"font-size":[{text:["base",r,th,Vu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,eh,Ju]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Fu,Qu]}],"font-family":[{font:[rh,Qu,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,eh,Qu]}],"line-clamp":[{"line-clamp":[Bu,"none",eh,Ju]}],leading:[{leading:[i,...w()]}],"list-image":[{"list-image":["none",eh,Qu]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",eh,Qu]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:E()}],"text-color":[{text:E()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[Bu,"from-font","auto",eh,Vu]}],"text-decoration-color":[{decoration:E()}],"underline-offset":[{"underline-offset":[Bu,"auto",eh,Qu]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:w()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",eh,Qu]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",eh,Qu]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:_()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:P()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Hu,eh,Qu],radial:["",eh,Qu],conic:[Hu,eh,Qu]},ih,Xu]}],"bg-color":[{bg:E()}],"gradient-from-pos":[{from:R()}],"gradient-via-pos":[{via:R()}],"gradient-to-pos":[{to:R()}],"gradient-from":[{from:E()}],"gradient-via":[{via:E()}],"gradient-to":[{to:E()}],rounded:[{rounded:O()}],"rounded-s":[{"rounded-s":O()}],"rounded-e":[{"rounded-e":O()}],"rounded-t":[{"rounded-t":O()}],"rounded-r":[{"rounded-r":O()}],"rounded-b":[{"rounded-b":O()}],"rounded-l":[{"rounded-l":O()}],"rounded-ss":[{"rounded-ss":O()}],"rounded-se":[{"rounded-se":O()}],"rounded-ee":[{"rounded-ee":O()}],"rounded-es":[{"rounded-es":O()}],"rounded-tl":[{"rounded-tl":O()}],"rounded-tr":[{"rounded-tr":O()}],"rounded-br":[{"rounded-br":O()}],"rounded-bl":[{"rounded-bl":O()}],"border-w":[{border:N()}],"border-w-x":[{"border-x":N()}],"border-w-y":[{"border-y":N()}],"border-w-s":[{"border-s":N()}],"border-w-e":[{"border-e":N()}],"border-w-t":[{"border-t":N()}],"border-w-r":[{"border-r":N()}],"border-w-b":[{"border-b":N()}],"border-w-l":[{"border-l":N()}],"divide-x":[{"divide-x":N()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":N()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:E()}],"border-color-x":[{"border-x":E()}],"border-color-y":[{"border-y":E()}],"border-color-s":[{"border-s":E()}],"border-color-e":[{"border-e":E()}],"border-color-t":[{"border-t":E()}],"border-color-r":[{"border-r":E()}],"border-color-b":[{"border-b":E()}],"border-color-l":[{"border-l":E()}],"divide-color":[{divide:E()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[Bu,eh,Qu]}],"outline-w":[{outline:["",Bu,th,Vu]}],"outline-color":[{outline:E()}],shadow:[{shadow:["","none",u,ah,Zu]}],"shadow-color":[{shadow:E()}],"inset-shadow":[{"inset-shadow":["none",h,ah,Zu]}],"inset-shadow-color":[{"inset-shadow":E()}],"ring-w":[{ring:N()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:E()}],"ring-offset-w":[{"ring-offset":[Bu,Vu]}],"ring-offset-color":[{"ring-offset":E()}],"inset-ring-w":[{"inset-ring":N()}],"inset-ring-color":[{"inset-ring":E()}],"text-shadow":[{"text-shadow":["none",d,ah,Zu]}],"text-shadow-color":[{"text-shadow":E()}],opacity:[{opacity:[Bu,eh,Qu]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Bu]}],"mask-image-linear-from-pos":[{"mask-linear-from":M()}],"mask-image-linear-to-pos":[{"mask-linear-to":M()}],"mask-image-linear-from-color":[{"mask-linear-from":E()}],"mask-image-linear-to-color":[{"mask-linear-to":E()}],"mask-image-t-from-pos":[{"mask-t-from":M()}],"mask-image-t-to-pos":[{"mask-t-to":M()}],"mask-image-t-from-color":[{"mask-t-from":E()}],"mask-image-t-to-color":[{"mask-t-to":E()}],"mask-image-r-from-pos":[{"mask-r-from":M()}],"mask-image-r-to-pos":[{"mask-r-to":M()}],"mask-image-r-from-color":[{"mask-r-from":E()}],"mask-image-r-to-color":[{"mask-r-to":E()}],"mask-image-b-from-pos":[{"mask-b-from":M()}],"mask-image-b-to-pos":[{"mask-b-to":M()}],"mask-image-b-from-color":[{"mask-b-from":E()}],"mask-image-b-to-color":[{"mask-b-to":E()}],"mask-image-l-from-pos":[{"mask-l-from":M()}],"mask-image-l-to-pos":[{"mask-l-to":M()}],"mask-image-l-from-color":[{"mask-l-from":E()}],"mask-image-l-to-color":[{"mask-l-to":E()}],"mask-image-x-from-pos":[{"mask-x-from":M()}],"mask-image-x-to-pos":[{"mask-x-to":M()}],"mask-image-x-from-color":[{"mask-x-from":E()}],"mask-image-x-to-color":[{"mask-x-to":E()}],"mask-image-y-from-pos":[{"mask-y-from":M()}],"mask-image-y-to-pos":[{"mask-y-to":M()}],"mask-image-y-from-color":[{"mask-y-from":E()}],"mask-image-y-to-color":[{"mask-y-to":E()}],"mask-image-radial":[{"mask-radial":[eh,Qu]}],"mask-image-radial-from-pos":[{"mask-radial-from":M()}],"mask-image-radial-to-pos":[{"mask-radial-to":M()}],"mask-image-radial-from-color":[{"mask-radial-from":E()}],"mask-image-radial-to-color":[{"mask-radial-to":E()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[Bu]}],"mask-image-conic-from-pos":[{"mask-conic-from":M()}],"mask-image-conic-to-pos":[{"mask-conic-to":M()}],"mask-image-conic-from-color":[{"mask-conic-from":E()}],"mask-image-conic-to-color":[{"mask-conic-to":E()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:_()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:P()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",eh,Qu]}],filter:[{filter:["","none",eh,Qu]}],blur:[{blur:q()}],brightness:[{brightness:[Bu,eh,Qu]}],contrast:[{contrast:[Bu,eh,Qu]}],"drop-shadow":[{"drop-shadow":["","none",g,ah,Zu]}],"drop-shadow-color":[{"drop-shadow":E()}],grayscale:[{grayscale:["",Bu,eh,Qu]}],"hue-rotate":[{"hue-rotate":[Bu,eh,Qu]}],invert:[{invert:["",Bu,eh,Qu]}],saturate:[{saturate:[Bu,eh,Qu]}],sepia:[{sepia:["",Bu,eh,Qu]}],"backdrop-filter":[{"backdrop-filter":["","none",eh,Qu]}],"backdrop-blur":[{"backdrop-blur":q()}],"backdrop-brightness":[{"backdrop-brightness":[Bu,eh,Qu]}],"backdrop-contrast":[{"backdrop-contrast":[Bu,eh,Qu]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Bu,eh,Qu]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Bu,eh,Qu]}],"backdrop-invert":[{"backdrop-invert":["",Bu,eh,Qu]}],"backdrop-opacity":[{"backdrop-opacity":[Bu,eh,Qu]}],"backdrop-saturate":[{"backdrop-saturate":[Bu,eh,Qu]}],"backdrop-sepia":[{"backdrop-sepia":["",Bu,eh,Qu]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":w()}],"border-spacing-x":[{"border-spacing-x":w()}],"border-spacing-y":[{"border-spacing-y":w()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",eh,Qu]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Bu,"initial",eh,Qu]}],ease:[{ease:["linear","initial",y,eh,Qu]}],delay:[{delay:[Bu,eh,Qu]}],animate:[{animate:["none",v,eh,Qu]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[f,eh,Qu]}],"perspective-origin":[{"perspective-origin":b()}],rotate:[{rotate:L()}],"rotate-x":[{"rotate-x":L()}],"rotate-y":[{"rotate-y":L()}],"rotate-z":[{"rotate-z":L()}],scale:[{scale:B()}],"scale-x":[{"scale-x":B()}],"scale-y":[{"scale-y":B()}],"scale-z":[{"scale-z":B()}],"scale-3d":["scale-3d"],skew:[{skew:H()}],"skew-x":[{"skew-x":H()}],"skew-y":[{"skew-y":H()}],transform:[{transform:[eh,Qu,"","none","gpu","cpu"]}],"transform-origin":[{origin:b()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:F()}],"translate-x":[{"translate-x":F()}],"translate-y":[{"translate-y":F()}],"translate-z":[{"translate-z":F()}],"translate-none":["translate-none"],accent:[{accent:E()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:E()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",eh,Qu]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":w()}],"scroll-mx":[{"scroll-mx":w()}],"scroll-my":[{"scroll-my":w()}],"scroll-ms":[{"scroll-ms":w()}],"scroll-me":[{"scroll-me":w()}],"scroll-mt":[{"scroll-mt":w()}],"scroll-mr":[{"scroll-mr":w()}],"scroll-mb":[{"scroll-mb":w()}],"scroll-ml":[{"scroll-ml":w()}],"scroll-p":[{"scroll-p":w()}],"scroll-px":[{"scroll-px":w()}],"scroll-py":[{"scroll-py":w()}],"scroll-ps":[{"scroll-ps":w()}],"scroll-pe":[{"scroll-pe":w()}],"scroll-pt":[{"scroll-pt":w()}],"scroll-pr":[{"scroll-pr":w()}],"scroll-pb":[{"scroll-pb":w()}],"scroll-pl":[{"scroll-pl":w()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",eh,Qu]}],fill:[{fill:["none",...E()]}],"stroke-w":[{stroke:[Bu,th,Vu,Ju]}],stroke:[{stroke:["none",...E()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}}));function yh(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return mh(uu(t))}var vh=["className"],bh=["className"],wh=["className"],kh=["className"];function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ch.apply(null,arguments)}function Ih(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Sh(e){var t=e.className,r=Ih(e,vh);return n.createElement("div",Ch({"data-slot":"card",className:yh("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t)},r))}function Th(e){var t=e.className,r=Ih(e,bh);return n.createElement("div",Ch({"data-slot":"card-header",className:yh("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t)},r))}function xh(e){var t=e.className,r=Ih(e,wh);return n.createElement("div",Ch({"data-slot":"card-title",className:yh("leading-none font-semibold",t)},r))}function Ah(e){var t=e.className,r=Ih(e,kh);return n.createElement("div",Ch({"data-slot":"card-content",className:yh("px-6",t)},r))}var Eh=r(64583).Promise;function _h(e){return _h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(e)}function Ph(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Rh(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rh(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Oh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Nh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oh(Object(r),!0).forEach((function(t){Mh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Mh(e,t,r){return(t=Fh(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qh(){qh=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==_h(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(_h(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Eh);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Lh(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Eh.resolve(c).then(n,o)}function Bh(e){return function(){var t=this,r=arguments;return new Eh((function(n,o){var i=e.apply(t,r);function a(e){Lh(i,n,o,a,s,"next",e)}function s(e){Lh(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Hh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fh(n.key),n)}}function Fh(e){var t=function(e){if("object"!=_h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=_h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_h(t)?t:t+""}var Dh=function(){return function(e,t){return t&&Hh(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl="https://dev.bridge.wassel.ai/api/v1",this.baseUrl2="https://dev.bridge.wassel.ai/api/v2",this.credentials={user_login_id:"bridge_plugin",password:"AAAAAAAAAAAAAAAAAAAAAJMO2C2JSwl6VTF0c6tz5dI="},this.accessToken=null,this.csrfToken=null,this.csrfCookie=null,this.currentWebSocket=null}),[{key:"isAuthenticated",value:function(){return!!this.accessToken}},{key:"getAccessToken",value:function(){return this.accessToken||(this.accessToken=localStorage.getItem("bridge_access_token")),this.accessToken}},{key:"setAccessToken",value:function(e){this.accessToken=e,localStorage.setItem("bridge_access_token",e)}},{key:"clearTokens",value:function(){if(this.accessToken=null,this.csrfToken=null,this.csrfCookie=null,localStorage.removeItem("bridge_access_token"),this.currentWebSocket&&"function"==typeof this.currentWebSocket.close){try{this.currentWebSocket.close()}catch(e){console.warn("Error closing WebSocket during cleanup:",e)}this.currentWebSocket=null}}},{key:"getCsrfToken",value:(n=Bh(qh().mark((function e(){var t,r,n,o;return qh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.baseUrl,"/get-csrf-token"),{method:"GET"});case 3:if((t=e.sent).ok){e.next=6;break}throw new Error("Failed to get CSRF token: ".concat(t.status));case 6:return e.next=8,t.json();case 8:r=e.sent,this.csrfToken=r.csrf_token,console.log(this.csrfToken),(n=t.headers.get("set-cookie"))&&(o=n.match(/csrf_cookie=([^;]+)/))&&(this.csrfCookie=o[1]),console.log("CSRF Token obtained:",this.csrfToken),e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),console.error("Error getting CSRF token:",e.t0),e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(){return n.apply(this,arguments)})},{key:"login",value:function(){var e=Bh(qh().mark((function e(){var t;return qh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.csrfToken){e.next=2;break}throw new Error("CSRF token not available");case 2:return e.prev=2,e.next=5,fetch("".concat(this.baseUrl,"/login"),{method:"POST",headers:Nh({"Content-Type":"application/json","X-CSRF-Token":this.csrfToken},this.csrfCookie&&{Cookie:"csrf_cookie=".concat(this.csrfCookie)}),body:JSON.stringify(this.credentials)});case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("Login failed: ".concat(t.status));case 8:console.log("Login successful"),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(2),console.error("Error during login:",e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"validateOtp",value:(r=Bh(qh().mark((function e(){var t,r,n;return qh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.csrfToken){e.next=2;break}throw new Error("CSRF token not available");case 2:return e.prev=2,e.next=5,fetch("".concat(this.baseUrl,"/validate_login_otp"),{method:"POST",headers:Nh({"Content-Type":"application/json","X-CSRF-Token":this.csrfToken},this.csrfCookie&&{Cookie:"csrf_cookie=".concat(this.csrfCookie)}),body:JSON.stringify({user_login_id:this.credentials.user_login_id,otp:"123456"})});case 5:if((t=e.sent).ok){e.next=8;break}throw new Error("OTP validation failed: ".concat(t.status));case 8:return e.next=10,t.json();case 10:if(r=e.sent,console.log(r),n=r.data.result.access_token){e.next=15;break}throw new Error("No access token received");case 15:return this.setAccessToken(n),console.log("Access token obtained and stored"),e.abrupt("return",n);case 20:throw e.prev=20,e.t0=e.catch(2),console.error("Error validating OTP:",e.t0),e.t0;case 24:case"end":return e.stop()}}),e,this,[[2,20]])}))),function(){return r.apply(this,arguments)})},{key:"authenticate",value:(t=Bh(qh().mark((function e(){var t,r;return qh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=this.getAccessToken())){e.next=5;break}return console.log("Using existing access token"),e.abrupt("return",t);case 5:return console.log("Starting authentication flow..."),e.next=8,this.getCsrfToken();case 8:return e.next=10,this.login();case 10:return e.next=12,this.validateOtp();case 12:return r=e.sent,e.abrupt("return",r);case 16:throw e.prev=16,e.t0=e.catch(0),console.error("Authentication flow failed:",e.t0),this.clearTokens(),e.t0;case 21:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(){return t.apply(this,arguments)})},{key:"generateSessionId",value:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}},{key:"sendAIRequest",value:(e=Bh(qh().mark((function e(t,r,n,o,i){var a,s,c=this,l=arguments;return qh().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(l.length>5&&void 0!==l[5])||l[5],e.next=3,this.authenticate();case 3:if(this.currentWebSocket&&"function"==typeof this.currentWebSocket.close){try{this.currentWebSocket.close()}catch(e){console.warn("Error closing existing WebSocket:",e)}this.currentWebSocket=null}return s=this.generateSessionId(),e.abrupt("return",new Eh((function(e,l){try{var u="wss://dev.bridge.wassel.ai/api/v2/ws/".concat(s,"?token=Bearer%20").concat(encodeURIComponent(c.accessToken));if(console.log("Creating WebSocket connection to:",u),c.currentWebSocket=new WebSocket(u),!c.currentWebSocket)return void l(new Error("Failed to create WebSocket connection"));var h,d="",g=!1;c.currentWebSocket.onopen=function(){console.log("WebSocket connected, sending AI request..."),h=setTimeout((function(){console.warn("WebSocket response timeout, closing connection"),c.currentWebSocket&&"function"==typeof c.currentWebSocket.close&&c.currentWebSocket.close()}),6e4);var e="\n  DOCUMENT ANALYSIS REQUEST:\n  \n  ".concat(t,"\n  \n  DOCUMENT CONTENT TO ANALYZE:\n  ").concat(r,"\n  \n  Please provide a detailed analysis based on the above document content.\n  "),n={metadata:{persona:"general",model_name:"GPT 4o",streaming:a,assistant_type:"Others",temperature:0,k:3},message_text:e,messages:[],app_id:"932032423a2e11f08815320489d79279"};console.log("Sending payload:",n);try{c.currentWebSocket.send(JSON.stringify(n))}catch(e){console.error("Error sending WebSocket message:",e),o&&o("Failed to send message"),l(new Error("Failed to send message"))}},c.currentWebSocket.onmessage=function(t){try{var r=t.data;if(d+=r,console.log("Received chunk:",r),d.includes("<Response>")){var a=Ph(d.split("<Response>"),1)[0];d=a.trim(),g=!0,i&&i(d),e({response:d,status:"completed",sessionId:s}),clearTimeout(h),c.currentWebSocket&&"function"==typeof c.currentWebSocket.close&&c.currentWebSocket.close(),c.currentWebSocket=null}else n&&n(r,d)}catch(e){console.error("Error processing WebSocket message:",e),o&&o("Failed to process response"),clearTimeout(h),l(e)}},c.currentWebSocket.onerror=function(e){console.error("WebSocket error:",e),o&&o("WebSocket connection error"),clearTimeout(h),l(new Error("WebSocket connection failed"))},c.currentWebSocket.onclose=function(t){console.log("WebSocket closed:",t.code,t.reason),c.currentWebSocket=null,clearTimeout(h),1e3===t.code||g||""!==d.trim()?g||""===d.trim()||(i&&i(d),e({response:d,status:"completed",sessionId:s})):(o&&o("Connection closed unexpectedly"),l(new Error("Connection closed unexpectedly")))}}catch(e){console.error("Error setting up WebSocket:",e),o&&o(e.message),l(e)}})));case 6:case"end":return e.stop()}}),e,this)}))),function(t,r,n,o,i){return e.apply(this,arguments)})},{key:"closeAIConnection",value:function(){if(this.currentWebSocket&&"function"==typeof this.currentWebSocket.close){try{this.currentWebSocket.close()}catch(e){console.warn("Error closing WebSocket:",e)}this.currentWebSocket=null}}}]);var e,t,r,n}(),Uh=new Dh,zh=r(64583).Promise;function jh(e){return jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jh(e)}function $h(){$h=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==jh(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(jh(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=zh);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Kh(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):zh.resolve(c).then(n,o)}function Gh(e){return function(){var t=this,r=arguments;return new zh((function(n,o){var i=e.apply(t,r);function a(e){Kh(i,n,o,a,s,"next",e)}function s(e){Kh(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Wh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qh(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qh(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Vh={documentSummary:"Please provide a comprehensive summary of this document, highlighting the main points and key information.",selectedText:"",structureValidation:"Please validate the structure of this document and provide a detailed response based on its content."},Jh=function(e){return e?e.replace(/"/g,"").replace(/\s+/g," ").replace(/\s+([,.!?;:])/g,"$1").replace(/\n\s+/g,"\n").replace(/\s+\n/g,"\n").trim():""},Yh=r(64583).Promise;var Xh={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Zh(e){Xh=e}var ed={exec:()=>null};function td(e,t=""){let r="string"==typeof e?e:e.source;const n={replace:(e,t)=>{let o="string"==typeof t?t:t.source;return o=o.replace(rd.caret,"$1"),r=r.replace(e,o),n},getRegex:()=>new RegExp(r,t)};return n}var rd={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},nd=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,od=/(?:[*+-]|\d{1,9}[.)])/,id=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ad=td(id).replace(/bull/g,od).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),sd=td(id).replace(/bull/g,od).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),cd=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ld=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ud=td(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ld).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),hd=td(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,od).getRegex(),dd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",gd=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,pd=td("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",gd).replace("tag",dd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),fd=td(cd).replace("hr",nd).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dd).getRegex(),md={blockquote:td(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",fd).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:ud,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:nd,html:pd,lheading:ad,list:hd,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:fd,table:ed,text:/^[^\n]+/},yd=td("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",nd).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dd).getRegex(),vd={...md,lheading:sd,table:yd,paragraph:td(cd).replace("hr",nd).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",yd).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dd).getRegex()},bd={...md,html:td("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",gd).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ed,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:td(cd).replace("hr",nd).replace("heading"," *#{1,6} *[^\n]").replace("lheading",ad).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wd=/^( {2,}|\\)\n(?!\s*$)/,kd=/[\p{P}\p{S}]/u,Cd=/[\s\p{P}\p{S}]/u,Id=/[^\s\p{P}\p{S}]/u,Sd=td(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Cd).getRegex(),Td=/(?!~)[\p{P}\p{S}]/u,xd=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ad=td(xd,"u").replace(/punct/g,kd).getRegex(),Ed=td(xd,"u").replace(/punct/g,Td).getRegex(),_d="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Pd=td(_d,"gu").replace(/notPunctSpace/g,Id).replace(/punctSpace/g,Cd).replace(/punct/g,kd).getRegex(),Rd=td(_d,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,Td).getRegex(),Od=td("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Id).replace(/punctSpace/g,Cd).replace(/punct/g,kd).getRegex(),Nd=td(/\\(punct)/,"gu").replace(/punct/g,kd).getRegex(),Md=td(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qd=td(gd).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ld=td("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qd).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Bd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Hd=td(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Bd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Fd=td(/^!?\[(label)\]\[(ref)\]/).replace("label",Bd).replace("ref",ld).getRegex(),Dd=td(/^!?\[(ref)\](?:\[\])?/).replace("ref",ld).getRegex(),Ud={_backpedal:ed,anyPunctuation:Nd,autolink:Md,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:wd,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:ed,emStrongLDelim:Ad,emStrongRDelimAst:Pd,emStrongRDelimUnd:Od,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:Hd,nolink:Dd,punctuation:Sd,reflink:Fd,reflinkSearch:td("reflink|nolink(?!\\()","g").replace("reflink",Fd).replace("nolink",Dd).getRegex(),tag:Ld,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:ed},zd={...Ud,link:td(/^!?\[(label)\]\((.*?)\)/).replace("label",Bd).getRegex(),reflink:td(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Bd).getRegex()},jd={...Ud,emStrongRDelimAst:Rd,emStrongLDelim:Ed,url:td(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},$d={...jd,br:td(wd).replace("{2,}","*").getRegex(),text:td(jd.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Kd={normal:md,gfm:vd,pedantic:bd},Gd={normal:Ud,gfm:jd,breaks:$d,pedantic:zd},Wd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qd=e=>Wd[e];function Vd(e,t){if(t){if(rd.escapeTest.test(e))return e.replace(rd.escapeReplace,Qd)}else if(rd.escapeTestNoEncode.test(e))return e.replace(rd.escapeReplaceNoEncode,Qd);return e}function Jd(e){try{e=encodeURI(e).replace(rd.percentDecode,"%")}catch{return null}return e}function Yd(e,t){const r=e.replace(rd.findPipe,((e,t,r)=>{let n=!1,o=t;for(;--o>=0&&"\\"===r[o];)n=!n;return n?"|":" |"})).split(rd.splitPipe);let n=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(rd.slashPipe,"|");return r}function Xd(e,t,r){const n=e.length;if(0===n)return"";let o=0;for(;o<n;){const i=e.charAt(n-o-1);if(i!==t||r){if(i===t||!r)break;o++}else o++}return e.slice(0,n-o)}function Zd(e,t,r,n,o){const i=t.href,a=t.title||null,s=e[1].replace(o.other.outputLinkReplace,"$1");n.state.inLink=!0;const c={type:"!"===e[0].charAt(0)?"image":"link",raw:r,href:i,title:a,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,c}var eg=class{options;rules;lexer;constructor(e){this.options=e||Xh}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Xd(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],r=function(e,t,r){const n=e.match(r.other.indentCodeCompensation);if(null===n)return t;const o=n[1];return t.split("\n").map((e=>{const t=e.match(r.other.beginningSpace);if(null===t)return e;const[n]=t;return n.length>=o.length?e.slice(o.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=Xd(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Xd(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=Xd(t[0],"\n").split("\n"),r="",n="";const o=[];for(;e.length>0;){let t=!1;const i=[];let a;for(a=0;a<e.length;a++)if(this.rules.other.blockquoteStart.test(e[a]))i.push(e[a]),t=!0;else{if(t)break;i.push(e[a])}e=e.slice(a);const s=i.join("\n"),c=s.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}\n${s}`:s,n=n?`${n}\n${c}`:c;const l=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,o,!0),this.lexer.state.top=l,0===e.length)break;const u=o.at(-1);if("code"===u?.type)break;if("blockquote"===u?.type){const t=u,i=t.raw+"\n"+e.join("\n"),a=this.blockquote(i);o[o.length-1]=a,r=r.substring(0,r.length-t.raw.length)+a.raw,n=n.substring(0,n.length-t.text.length)+a.text;break}if("list"!==u?.type);else{const t=u,i=t.raw+"\n"+e.join("\n"),a=this.list(i);o[o.length-1]=a,r=r.substring(0,r.length-u.raw.length)+a.raw,n=n.substring(0,n.length-t.raw.length)+a.raw,e=i.substring(o.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:r,tokens:o,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const n=r.length>1,o={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");const i=this.rules.other.listItemRegex(r);let a=!1;for(;e;){let r=!1,n="",s="";if(!(t=i.exec(e)))break;if(this.rules.block.hr.test(e))break;n=t[0],e=e.substring(n.length);let c=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),l=e.split("\n",1)[0],u=!c.trim(),h=0;if(this.options.pedantic?(h=2,s=c.trimStart()):u?h=t[1].length+1:(h=t[2].search(this.rules.other.nonSpaceChar),h=h>4?1:h,s=c.slice(h),h+=t[1].length),u&&this.rules.other.blankLine.test(l)&&(n+=l+"\n",e=e.substring(l.length+1),r=!0),!r){const t=this.rules.other.nextBulletRegex(h),r=this.rules.other.hrRegex(h),o=this.rules.other.fencesBeginRegex(h),i=this.rules.other.headingBeginRegex(h),a=this.rules.other.htmlBeginRegex(h);for(;e;){const d=e.split("\n",1)[0];let g;if(l=d,this.options.pedantic?(l=l.replace(this.rules.other.listReplaceNesting,"  "),g=l):g=l.replace(this.rules.other.tabCharGlobal,"    "),o.test(l))break;if(i.test(l))break;if(a.test(l))break;if(t.test(l))break;if(r.test(l))break;if(g.search(this.rules.other.nonSpaceChar)>=h||!l.trim())s+="\n"+g.slice(h);else{if(u)break;if(c.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(o.test(c))break;if(i.test(c))break;if(r.test(c))break;s+="\n"+l}u||l.trim()||(u=!0),n+=d+"\n",e=e.substring(d.length+1),c=g.slice(h)}}o.loose||(a?o.loose=!0:this.rules.other.doubleBlankLine.test(n)&&(a=!0));let d,g=null;this.options.gfm&&(g=this.rules.other.listIsTask.exec(s),g&&(d="[ ] "!==g[0],s=s.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:n,task:!!g,checked:d,loose:!1,text:s,tokens:[]}),o.raw+=n}const s=o.items.at(-1);if(!s)return;s.raw=s.raw.trimEnd(),s.text=s.text.trimEnd(),o.raw=o.raw.trimEnd();for(let e=0;e<o.items.length;e++)if(this.lexer.state.top=!1,o.items[e].tokens=this.lexer.blockTokens(o.items[e].text,[]),!o.loose){const t=o.items[e].tokens.filter((e=>"space"===e.type)),r=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));o.loose=r}if(o.loose)for(let e=0;e<o.items.length;e++)o.items[e].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:r,title:n}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const r=Yd(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===n.length){for(const e of n)this.rules.other.tableAlignRight.test(e)?i.align.push("right"):this.rules.other.tableAlignCenter.test(e)?i.align.push("center"):this.rules.other.tableAlignLeft.test(e)?i.align.push("left"):i.align.push(null);for(let e=0;e<r.length;e++)i.header.push({text:r[e],tokens:this.lexer.inline(r[e]),header:!0,align:i.align[e]});for(const e of o)i.rows.push(Yd(e,i.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:i.align[t]}))));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=Xd(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let r=0;for(let n=0;n<e.length;n++)if("\\"===e[n])n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&(r--,r<0))return n;return r>0?-2:-1}(t[2],"()");if(-2===e)return;if(e>-1){const r=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,r).trim(),t[3]=""}}let r=t[2],n="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(r);e&&(r=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(r=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?r.slice(1):r.slice(1,-1)),Zd(t,{href:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r,title:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const e=t[(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=r[0].charAt(0);return{type:"text",raw:e,text:e}}return Zd(r,e,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(n&&(!n[3]||!r.match(this.rules.other.unicodeAlphaNumeric))&&(!n[1]&&!n[2]||!r||this.rules.inline.punctuation.exec(r))){const r=[...n[0]].length-1;let o,i,a=r,s=0;const c="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+r);null!=(n=c.exec(t));){if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!o)continue;if(i=[...o].length,n[3]||n[4]){a+=i;continue}if((n[5]||n[6])&&r%3&&!((r+i)%3)){s+=i;continue}if(a-=i,a>0)continue;i=Math.min(i,i+a+s);const t=[...n[0]][0].length,c=e.slice(0,r+n.index+t+i);if(Math.min(r,i)%2){const e=c.slice(1,-1);return{type:"em",raw:c,text:e,tokens:this.lexer.inlineTokens(e)}}const l=c.slice(2,-2);return{type:"strong",raw:c,text:l,tokens:this.lexer.inlineTokens(l)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(e),n=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return r&&n&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,r;return"@"===t[2]?(e=t[1],r="mailto:"+e):(e=t[1],r=e),{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,r;if("@"===t[2])e=t[0],r="mailto:"+e;else{let n;do{n=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(n!==t[0]);e=t[0],r="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}},tg=class e{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Xh,this.options.tokenizer=this.options.tokenizer||new eg,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:rd,block:Kd.normal,inline:Gd.normal};this.options.pedantic?(t.block=Kd.pedantic,t.inline=Gd.pedantic):this.options.gfm&&(t.block=Kd.gfm,this.options.breaks?t.inline=Gd.breaks:t.inline=Gd.gfm),this.tokenizer.rules=t}static get rules(){return{block:Kd,inline:Gd}}static lex(t,r){return new e(r).lex(t)}static lexInline(t,r){return new e(r).inlineTokens(t)}lex(e){e=e.replace(rd.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(rd.tabCharGlobal,"    ").replace(rd.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some((r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);const r=t.at(-1);1===n.raw.length&&void 0!==r?r.raw+="\n":t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);const r=t.at(-1);"paragraph"===r?.type||"text"===r?.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.at(-1).src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);const r=t.at(-1);"paragraph"===r?.type||"text"===r?.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.raw,this.inlineQueue.at(-1).src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}let o=e;if(this.options.extensions?.startBlock){let t=1/0;const r=e.slice(1);let n;this.options.extensions.startBlock.forEach((e=>{n=e.call({lexer:this},r),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(o=e.substring(0,t+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o))){const i=t.at(-1);r&&"paragraph"===i?.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):t.push(n),r=o.length!==e.length,e=e.substring(n.raw.length)}else if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);const r=t.at(-1);"text"===r?.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):t.push(n)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,n=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(n=this.tokenizer.rules.inline.reflinkSearch.exec(r));)e.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(n=this.tokenizer.rules.inline.anyPunctuation.exec(r));)r=r.slice(0,n.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(n=this.tokenizer.rules.inline.blockSkip.exec(r));)r=r.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,i="";for(;e;){let n;if(o||(i=""),o=!1,this.options.extensions?.inline?.some((r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))continue;if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length);const r=t.at(-1);"text"===n.type&&"text"===r?.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,r,i)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}let a=e;if(this.options.extensions?.startInline){let t=1/0;const r=e.slice(1);let n;this.options.extensions.startInline.forEach((e=>{n=e.call({lexer:this},r),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(a)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(i=n.raw.slice(-1)),o=!0;const r=t.at(-1);"text"===r?.type?(r.raw+=n.raw,r.text+=n.text):t.push(n)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}},rg=class{options;parser;constructor(e){this.options=e||Xh}space(e){return""}code({text:e,lang:t,escaped:r}){const n=(t||"").match(rd.notSpaceStart)?.[0],o=e.replace(rd.endingNewline,"")+"\n";return n?'<pre><code class="language-'+Vd(n)+'">'+(r?o:Vd(o,!0))+"</code></pre>\n":"<pre><code>"+(r?o:Vd(o,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,r=e.start;let n="";for(let t=0;t<e.items.length;t++){const r=e.items[t];n+=this.listitem(r)}const o=t?"ol":"ul";return"<"+o+(t&&1!==r?' start="'+r+'"':"")+">\n"+n+"</"+o+">\n"}listitem(e){let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=r+" "+Vd(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",r="";for(let t=0;t<e.header.length;t++)r+=this.tablecell(e.header[t]);t+=this.tablerow({text:r});let n="";for(let t=0;t<e.rows.length;t++){const o=e.rows[t];r="";for(let e=0;e<o.length;e++)r+=this.tablecell(o[e]);n+=this.tablerow({text:r})}return n&&(n=`<tbody>${n}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+n+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Vd(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){const n=this.parser.parseInline(r),o=Jd(e);if(null===o)return n;let i='<a href="'+(e=o)+'"';return t&&(i+=' title="'+Vd(t)+'"'),i+=">"+n+"</a>",i}image({href:e,title:t,text:r,tokens:n}){n&&(r=this.parser.parseInline(n,this.parser.textRenderer));const o=Jd(e);if(null===o)return Vd(r);let i=`<img src="${e=o}" alt="${r}"`;return t&&(i+=` title="${Vd(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Vd(e.text)}},ng=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},og=class e{options;renderer;textRenderer;constructor(e){this.options=e||Xh,this.options.renderer=this.options.renderer||new rg,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ng}static parse(t,r){return new e(r).parse(t)}static parseInline(t,r){return new e(r).parseInline(t)}parse(e,t=!0){let r="";for(let n=0;n<e.length;n++){const o=e[n];if(this.options.extensions?.renderers?.[o.type]){const e=o,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){r+=t||"";continue}}const i=o;switch(i.type){case"space":r+=this.renderer.space(i);continue;case"hr":r+=this.renderer.hr(i);continue;case"heading":r+=this.renderer.heading(i);continue;case"code":r+=this.renderer.code(i);continue;case"table":r+=this.renderer.table(i);continue;case"blockquote":r+=this.renderer.blockquote(i);continue;case"list":r+=this.renderer.list(i);continue;case"html":r+=this.renderer.html(i);continue;case"paragraph":r+=this.renderer.paragraph(i);continue;case"text":{let o=i,a=this.renderer.text(o);for(;n+1<e.length&&"text"===e[n+1].type;)o=e[++n],a+="\n"+this.renderer.text(o);r+=t?this.renderer.paragraph({type:"paragraph",raw:a,text:a,tokens:[{type:"text",raw:a,text:a,escaped:!0}]}):a;continue}default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return r}parseInline(e,t=this.renderer){let r="";for(let n=0;n<e.length;n++){const o=e[n];if(this.options.extensions?.renderers?.[o.type]){const e=this.options.extensions.renderers[o.type].call({parser:this},o);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=e||"";continue}}const i=o;switch(i.type){case"escape":case"text":r+=t.text(i);break;case"html":r+=t.html(i);break;case"link":r+=t.link(i);break;case"image":r+=t.image(i);break;case"strong":r+=t.strong(i);break;case"em":r+=t.em(i);break;case"codespan":r+=t.codespan(i);break;case"br":r+=t.br(i);break;case"del":r+=t.del(i);break;default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return r}},ig=class{options;block;constructor(e){this.options=e||Xh}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?tg.lex:tg.lexInline}provideParser(){return this.block?og.parse:og.parseInline}},ag=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=og;Renderer=rg;TextRenderer=ng;Lexer=tg;Tokenizer=eg;Hooks=ig;constructor(...e){this.use(...e)}walkTokens(e,t){let r=[];for(const n of e)switch(r=r.concat(t.call(this,n)),n.type){case"table":{const e=n;for(const n of e.header)r=r.concat(this.walkTokens(n.tokens,t));for(const n of e.rows)for(const e of n)r=r.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=n;r=r.concat(this.walkTokens(e.items,t));break}default:{const e=n;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((n=>{const o=e[n].flat(1/0);r=r.concat(this.walkTokens(o,t))})):e.tokens&&(r=r.concat(this.walkTokens(e.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const r={...e};if(r.async=this.defaults.async||r.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const r=t.renderers[e.name];t.renderers[e.name]=r?function(...t){let n=e.renderer.apply(this,t);return!1===n&&(n=r.apply(this,t)),n}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const r=t[e.level];r?r.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),r.extensions=t),e.renderer){const t=this.defaults.renderer||new rg(this.defaults);for(const r in e.renderer){if(!(r in t))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const n=r,o=e.renderer[n],i=t[n];t[n]=(...e)=>{let r=o.apply(t,e);return!1===r&&(r=i.apply(t,e)),r||""}}r.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new eg(this.defaults);for(const r in e.tokenizer){if(!(r in t))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const n=r,o=e.tokenizer[n],i=t[n];t[n]=(...e)=>{let r=o.apply(t,e);return!1===r&&(r=i.apply(t,e)),r}}r.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new ig;for(const r in e.hooks){if(!(r in t))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const n=r,o=e.hooks[n],i=t[n];ig.passThroughHooks.has(r)?t[n]=e=>{if(this.defaults.async)return Yh.resolve(o.call(t,e)).then((e=>i.call(t,e)));const r=o.call(t,e);return i.call(t,r)}:t[n]=(...e)=>{let r=o.apply(t,e);return!1===r&&(r=i.apply(t,e)),r}}r.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,n=e.walkTokens;r.walkTokens=function(e){let r=[];return r.push(n.call(this,e)),t&&(r=r.concat(t.call(this,e))),r}}this.defaults={...this.defaults,...r}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return tg.lex(e,t??this.defaults)}parser(e,t){return og.parse(e,t??this.defaults)}parseMarkdown(e){return(t,r)=>{const n={...r},o={...this.defaults,...n},i=this.onError(!!o.silent,!!o.async);if(!0===this.defaults.async&&!1===n.async)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return i(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);const a=o.hooks?o.hooks.provideLexer():e?tg.lex:tg.lexInline,s=o.hooks?o.hooks.provideParser():e?og.parse:og.parseInline;if(o.async)return Yh.resolve(o.hooks?o.hooks.preprocess(t):t).then((e=>a(e,o))).then((e=>o.hooks?o.hooks.processAllTokens(e):e)).then((e=>o.walkTokens?Yh.all(this.walkTokens(e,o.walkTokens)).then((()=>e)):e)).then((e=>s(e,o))).then((e=>o.hooks?o.hooks.postprocess(e):e)).catch(i);try{o.hooks&&(t=o.hooks.preprocess(t));let e=a(t,o);o.hooks&&(e=o.hooks.processAllTokens(e)),o.walkTokens&&this.walkTokens(e,o.walkTokens);let r=s(e,o);return o.hooks&&(r=o.hooks.postprocess(r)),r}catch(e){return i(e)}}}onError(e,t){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+Vd(r.message+"",!0)+"</pre>";return t?Yh.resolve(e):e}if(t)return Yh.reject(r);throw r}}};function sg(e,t){return ag.parse(e,t)}sg.options=sg.setOptions=function(e){return ag.setOptions(e),sg.defaults=ag.defaults,Zh(sg.defaults),sg},sg.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},sg.defaults=Xh,sg.use=function(...e){return ag.use(...e),sg.defaults=ag.defaults,Zh(sg.defaults),sg},sg.walkTokens=function(e,t){return ag.walkTokens(e,t)},sg.parseInline=ag.parseInline,sg.Parser=og,sg.parser=og.parse,sg.Renderer=rg,sg.TextRenderer=ng,sg.Lexer=tg,sg.lexer=tg.lex,sg.Tokenizer=eg,sg.Hooks=ig,sg.parse=sg,sg.options,sg.setOptions,sg.use,sg.walkTokens,sg.parseInline,og.parse,tg.lex;const cg=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,lg=uu,ug=(e,t)=>r=>{var n;if(null==(null==t?void 0:t.variants))return lg(e,null==r?void 0:r.class,null==r?void 0:r.className);const{variants:o,defaultVariants:i}=t,a=Object.keys(o).map((e=>{const t=null==r?void 0:r[e],n=null==i?void 0:i[e];if(null===t)return null;const a=cg(t)||cg(n);return o[e][a]})),s=r&&Object.entries(r).reduce(((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e}),{}),c=null==t||null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce(((e,t)=>{let{class:r,className:n,...o}=t;return Object.entries(o).every((e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...i,...s}[t]):{...i,...s}[t]===r}))?[...e,r,n]:e}),[]);return lg(e,a,c,null==r?void 0:r.class,null==r?void 0:r.className)};var hg=["className","variant","size","asChild"];function dg(){return dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dg.apply(null,arguments)}var gg=ug("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pg=n.forwardRef((function(e,t){var r=e.className,o=e.variant,i=e.size,a=e.asChild,s=void 0!==a&&a,c=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,hg),l=s?"slot":"button";return n.createElement(l,dg({className:yh(gg({variant:o,size:i,className:r})),ref:t},c))}));pg.displayName="Button";const fg=su("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),mg=su("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),yg=su("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),vg=su("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),bg=su("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),wg=su("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var kg=r(64583).Promise;function Cg(e){return Cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cg(e)}function Ig(){Ig=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Cg(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Cg(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=kg);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Sg(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):kg.resolve(c).then(n,o)}var Tg=function(e){var t=e.streamingResponse,r=e.isStreaming,o=e.isLoading,i=e.error,a=e.onClear,s=e.onStop,c=function(){var e,r=(e=Ig().mark((function e(){return Ig().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(t);case 3:console.log("Response copied to clipboard"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Failed to copy to clipboard:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var t=this,r=arguments;return new kg((function(n,o){var i=e.apply(t,r);function a(e){Sg(i,n,o,a,s,"next",e)}function s(e){Sg(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();sg.setOptions({breaks:!0,gfm:!0,headerIds:!1,mangle:!1,sanitize:!1});var l=t?sg(t.replace(/\\n/g,"\n").replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/\\([^\n\\]+)\\/g,"_$1_")):"";return n.createElement(Sh,{className:"border-green-200"},n.createElement(Th,null,n.createElement(xh,{className:"flex items-center justify-between"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement(fg,{className:"h-5 w-5 text-green-600"}),n.createElement("span",null,"AI Analysis"),r&&n.createElement(mg,{className:"h-4 w-4 animate-spin text-green-600"}),!r&&t&&n.createElement(yg,{className:"h-4 w-4 text-green-600"})),n.createElement("div",{className:"flex sm:flex-row flex-col items-center space-x-2"},t&&n.createElement("div",{className:"flex flex-row items-center space-x-2"},n.createElement(pg,{variant:"outline",size:"sm",onClick:c},n.createElement(vg,{className:"h-4 w-4 mr-1"}),"Copy"),n.createElement(pg,{variant:"outline",size:"sm",onClick:a},n.createElement(bg,{className:"h-4 w-4 mr-1"}),"Clear")),r&&n.createElement(pg,{variant:"outline",size:"sm",onClick:s,className:"text-red-600"},n.createElement(wg,{className:"h-4 w-4 mr-1"}),"Stop")))),n.createElement(Ah,null,i&&n.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},n.createElement("p",{className:"text-sm text-red-800"},i)),o&&!r&&n.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement(mg,{className:"h-4 w-4 animate-spin text-blue-600"}),n.createElement("span",{className:"text-sm text-blue-800"},"Connecting to AI..."))),r&&n.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("span",{className:"text-sm text-blue-800"},"AI is analyzing your document... (",t.trim().split(/\s+/).filter((function(e){return e.length>0})).length," words so far)"))),t?n.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},n.createElement("div",{className:"prose prose-sm max-w-none text-green-800 leading-relaxed",dangerouslySetInnerHTML:{__html:l}}),r&&n.createElement("span",{className:"animate-pulse ml-1 text-green-600 font-bold"},"")):n.createElement("div",{className:"bg-gray-50 rounded-lg p-4 text-center"},n.createElement("p",{className:"text-sm text-gray-500"},"Click a ribbon button to start processing your document with AI."))))},xg=r(64583).Promise;function Ag(e){return Ag="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ag(e)}function Eg(){Eg=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Ag(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Ag(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=xg);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function _g(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):xg.resolve(c).then(n,o)}function Pg(e){return function(){var t=this,r=arguments;return new xg((function(n,o){var i=e.apply(t,r);function a(e){_g(i,n,o,a,s,"next",e)}function s(e){_g(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Rg(){try{return Word.run(function(){var e=Pg(Eg().mark((function e(t){var r,n;return Eg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).clear(),(n=r.insertText(" Processing your request...",Word.InsertLocation.replace)).font.color="#6B7280",n.font.italic=!0,e.next=7,t.sync();case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(e){return console.error("Error inserting processing indicator:",e),!1}}function Og(){try{return Word.run(function(){var e=Pg(Eg().mark((function e(t){var r,n;return Eg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.document.body,(n=r.search(" Processing your request...")).load("text"),e.next=5,t.sync();case 5:return n.items.forEach((function(e){e.delete()})),e.next=8,t.sync();case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(e){return console.error("Error removing processing indicator:",e),!1}}var Ng=r(64583).Promise;function Mg(e){return Mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mg(e)}function qg(){qg=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Mg(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Mg(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Ng);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Lg(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Ng.resolve(c).then(n,o)}function Bg(e){return function(){var t=this,r=arguments;return new Ng((function(n,o){var i=e.apply(t,r);function a(e){Lg(i,n,o,a,s,"next",e)}function s(e){Lg(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Hg(e,t){return Fg.apply(this,arguments)}function Fg(){return Fg=Bg(qg().mark((function e(t,r){var n;return qg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,null==r||r("Formatting response"),e.next=6,Word.run(function(){var e=Bg(qg().mark((function e(r){var n,o,i,a,s,c,l;return qg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.document.body.clear(),e.next=3,r.sync();case 3:n=Dg(t),o=0;case 5:if(!(o<n.length)){e.next=48;break}if(i=n[o],!(o>0)){e.next=11;break}return r.document.body.insertParagraph("","End"),e.next=11,r.sync();case 11:if("heading"!==i.type){e.next=24;break}return a=r.document.body.insertParagraph(i.text,"End"),e.next=15,r.sync();case 15:return a.font.name="Calibri",a.font.size=16,a.font.bold=!0,a.font.color="#2B579A",a.paragraphFormat.spaceAfter=12,e.next=22,r.sync();case 22:e.next=45;break;case 24:if("list"!==i.type){e.next=39;break}s=0;case 26:if(!(s<i.items.length)){e.next=37;break}return c=r.document.body.insertParagraph(" ".concat(i.items[s]),"End"),e.next=30,r.sync();case 30:return c.font.name="Calibri",c.paragraphFormat.leftIndent=36,e.next=34,r.sync();case 34:s++,e.next=26;break;case 37:e.next=45;break;case 39:return l=r.document.body.insertParagraph(i.text,"End"),e.next=42,r.sync();case 42:return l.font.name="Calibri",e.next=45,r.sync();case 45:o++,e.next=5;break;case 48:return e.abrupt("return",!0);case 49:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:return n=e.sent,null==r||r(" Response formatted and inserted!"),e.abrupt("return",n);case 11:return e.prev=11,e.t0=e.catch(2),console.error("Word formatting error:",e.t0),null==r||r(" Failed to format response"),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),Fg.apply(this,arguments)}function Dg(e){var t=e.replace(/<\/?Response>/g,"").replace(/\\n/g,"\n").replace(/\*\*/g,"").trim().split("\n").filter((function(e){return e.trim()})),r=[],n=null;return t.forEach((function(e){var t,o=e.trim();(t=o)&&/^[A-Z][A-Za-z0-9 ]+[:.]?$/.test(t)&&!t.startsWith("-")&&t.split(" ").length<=5?(n&&r.push(n),r.push({type:"heading",text:o}),n=null):function(e){return/^[-*]\s+.+$/.test(e)}(o)?(n&&"list"===n.type||(n&&r.push(n),n={type:"list",items:[]}),n.items.push(o.replace(/^[-*]\s+/,""))):(n&&"list"!==n.type||(n&&r.push(n),n={type:"paragraph",text:""}),n.text+=(n.text?" ":"")+o)})),n&&r.push(n),r}var Ug=function(){return n.createElement("div",{className:"flex items-center"},n.createElement("img",{src:"/assets/bridge-logo-Photoroom.png",alt:"Logo",className:" max-h-16 object-cover"}))};function zg(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return mh(uu(t))}var jg=["className","variant","size","asChild"];function $g(){return $g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$g.apply(null,arguments)}var Kg=ug("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-blue-200 bg-transparent hover:bg-blue-100 text-blue-700",secondary:"bg-blue-100 text-blue-700 hover:bg-blue-200",ghost:"hover:bg-blue-100 hover:text-blue-700",link:"text-blue-700 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-8 rounded-md px-1 text-xs",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Gg=n.forwardRef((function(e,t){var r=e.className,o=e.variant,i=e.size,a=(e.asChild,function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,jg));return n.createElement("button",$g({className:zg(Kg({variant:o,size:i,className:r})),ref:t},a))}));Gg.displayName="Button";var Wg=function(e){var t=e.microsoftAccount,r=e.isLoggingOut,o=e.onLogout;return n.createElement("header",{className:"bg-white shadow-sm p-1"},n.createElement("div",{className:"flex items-center justify-between"},n.createElement("div",{className:"flex items-center space-x-3"},n.createElement("div",{className:"flex flex-col items-center  "},n.createElement(Ug,null),n.createElement("p",{className:"text-sm font-medium"},"V 1.0")),n.createElement("div",{className:""},n.createElement("div",null,n.createElement("p",{className:"text-xs text-gray-500  flex flex-col"},n.createElement("span",{className:"font-bold"},"Signed in as: ")," ",t.username)))),n.createElement(Gg,{variant:"link",size:"sm",onClick:o,disabled:r,className:"text-red-600 mt-3 mb-auto border-red-200 hover:bg-red-50"},r?"Signing Out...":"Sign Out")))},Qg=r(64583).Promise;function Vg(e){return Vg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(e)}function Jg(){Jg=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Vg(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Vg(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Qg);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function Yg(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Qg.resolve(c).then(n,o)}function Xg(e){return function(){var t=this,r=arguments;return new Qg((function(n,o){var i=e.apply(t,r);function a(e){Yg(i,n,o,a,s,"next",e)}function s(e){Yg(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Zg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ep(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ep(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var tp=function(e){var t=e.onLogout,r=tu().logoutWithMicrosoft,o=Zg((0,n.useState)(null),2),i=o[0],a=o[1],s=Zg((0,n.useState)(!1),2),c=s[0],l=s[1],u=Zg((0,n.useState)(""),2),h=u[0],d=u[1],g=Zg((0,n.useState)(!1),2),p=(g[0],g[1]),f=Zg((0,n.useState)(null),2),m=f[0],y=f[1],v=Zg((0,n.useState)(""),2),b=(v[0],v[1]),w=Zg((0,n.useState)(!1),2),k=(w[0],w[1]),C=function(){var e=Wh((0,n.useState)(!1),2),t=e[0],r=e[1],o=Wh((0,n.useState)(null),2),i=o[0],a=o[1],s=Wh((0,n.useState)(!1),2),c=s[0],l=s[1],u=Wh((0,n.useState)(""),2),h=u[0],d=u[1],g=Wh((0,n.useState)(!1),2),p=g[0],f=g[1],m=(0,n.useRef)(!1),y=(0,n.useRef)(""),v=(0,n.useCallback)(Gh($h().mark((function e(){var t;return $h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),a(null),e.next=5,Uh.authenticate();case 5:l(!0),console.log("Bridge AI authentication successful"),e.next=15;break;case 9:throw e.prev=9,e.t0=e.catch(0),t=e.t0 instanceof Error?e.t0.message:"Authentication failed",a(t),l(!1),e.t0;case 15:return e.prev=15,r(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,9,15,18]])}))),[]),b=(0,n.useCallback)(function(){var e=Gh($h().mark((function e(t,n){var o,i,s,c,l,u,h,g=arguments;return $h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(g.length>2&&void 0!==g[2]?g[2]:{}).streaming,i=void 0===o||o,e.prev=2,a(null),d(""),f(i),m.current=!1,y.current="",Uh.isAuthenticated()){e.next=13;break}return r(!0),e.next=12,v();case 12:r(!1);case 13:return s=Vh[t]||Vh.documentSummary,c=function(e){if(!m.current){y.current+=e;var t=Jh(y.current);d(t)}},l=function(e){a(e),f(!1)},u=function(e){if(e){var t=Jh(e);d(t)}f(!1)},e.next=19,Uh.sendAIRequest(s,n,c,l,u,i);case 19:e.next=27;break;case 21:throw e.prev=21,e.t0=e.catch(2),h=e.t0 instanceof Error?e.t0.message:"AI request failed",a(h),f(!1),e.t0;case 27:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t,r){return e.apply(this,arguments)}}(),[v]),w=(0,n.useCallback)((function(){d(""),y.current="",a(null),f(!1),m.current=!1}),[]),k=(0,n.useCallback)((function(){m.current=!0,Uh.closeAIConnection(),f(!1),r(!1)}),[]),C=(0,n.useCallback)((function(){Uh.clearTokens(),l(!1),a(null),d(""),y.current="",f(!1),m.current=!1}),[]);return{isLoading:t,error:i,isAuthenticated:c||Uh.isAuthenticated(),streamingResponse:h,isStreaming:p,authenticate:v,sendAIRequest:b,clearResponse:w,stopStreaming:k,logout:C}}(),I=C.isLoading,S=C.error,T=C.streamingResponse,x=C.isStreaming,A=C.sendAIRequest,E=C.clearResponse,_=C.logout,P=C.stopStreaming;console.log("Streaming response:",T),(0,n.useEffect)((function(){Kl.getAccount().then(a).catch(console.error)}),[]),(0,n.useEffect)((function(){var e=function(){var e=JSON.parse(localStorage.getItem("selectedTextForProcessing")||"{}");null!=e&&e.type&&(y(e.type),d(e.text||""),p(!0),b("Received text from Word..."))};return e(),window.addEventListener("storage",e),function(){return window.removeEventListener("storage",e)}}),[]),(0,n.useEffect)((function(){m&&h&&R(m)}),[m,h]),(0,n.useEffect)((function(){if(console.log("Stream check:",{isStreaming:x,response:null==T?void 0:T.slice(0,50)}),!x&&T){var e=T.replace(/<\/?Response>/g,"").trim();e&&"textToProcess"===m&&(console.log("Processing response:",e),q(e)),Og().catch((function(e){return console.error("Failed to remove processing indicator:",e)})),p(!1)}}),[x,T,m]);var R=function(e){({textToProcess:function(){return O(h)},summarizeDocument:function(){return N()},validateStructure:function(){return M()}}[e]||function(){return console.log("Unknown event:",e)})()},O=function(){var e=Xg(Jg().mark((function e(t){return Jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("Processing..."),e.prev=1,e.next=4,Rg();case 4:console.log("Processing indicator inserted"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Failed to insert processing indicator:",e.t0);case 10:return e.prev=10,e.next=13,A("selectedText",t.replace(" Process Text","").trim(),{streaming:!0});case 13:b("AI processing..."),e.next=20;break;case 16:e.prev=16,e.t1=e.catch(10),console.error("AI error:",e.t1),b("Error: AI failed");case 20:case"end":return e.stop()}}),e,null,[[1,7],[10,16]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Xg(Jg().mark((function e(){return Jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("Summarizing..."),e.prev=1,e.next=4,A("documentSummary",h,{streaming:!0});case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Summarization error:",e.t0),b("Error: Summarization failed");case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Xg(Jg().mark((function e(){return Jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("Validating..."),e.prev=1,e.next=4,A("structureValidation",h,{streaming:!0});case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Validation error:",e.t0),b("Error: Validation failed");case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Xg(Jg().mark((function e(t){var r;return Jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!x){e.next=2;break}return e.abrupt("return");case 2:return b("Formatting response..."),k(!0),r=t.replace(/<\/?Response>/g,"").trim(),console.log("Original response (first 200 chars):",t.substring(0,200)),console.log("Cleaned response (first 200 chars):",r.substring(0,200)),e.prev=7,e.next=10,Hg(r,b);case 10:e.sent||(console.warn("formatAndInsertToWord returned false"),b(" Failed to format response")),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("Error during formatAndInsertToWord:",e.t0),b(" Failed to format response");case 18:return e.prev=18,k(!1),setTimeout((function(){return b("")}),3e3),e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[7,14,18,22]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Xg(Jg().mark((function e(){return Jg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,r();case 4:_(),a(null),d(""),b(""),t&&t(),window.location.reload(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Logout error:",e.t0),alert("Logout failed. Try again.");case 16:return e.prev=16,l(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,12,16,19]])})));return function(){return e.apply(this,arguments)}}();return n.createElement("div",{className:"h-screen w-full flex flex-col bg-gray-50"},i&&n.createElement(Wg,{isLoggingOut:c,microsoftAccount:i,onLogout:L}),n.createElement("main",{className:"flex-1 p-6 overflow-auto"},n.createElement("div",{className:"max-w-4xl mx-auto space-y-6"},I&&!x&&n.createElement(Sh,{className:"border-blue-200 bg-blue-50"},n.createElement(Ah,{className:"p-4 flex items-center space-x-2"},n.createElement("span",{className:"text-sm text-blue-800"},"Connecting to AI..."))),S&&n.createElement(Sh,{className:"border-red-200 bg-red-50"},n.createElement(Ah,{className:"p-4 flex items-center space-x-2"},n.createElement(cu,{className:"h-4 w-4 text-red-600"}),n.createElement("span",{className:"text-sm text-red-800"},"Error: ",S))),"textToProcess"!==m&&n.createElement(Tg,{streamingResponse:T,isStreaming:x,isLoading:I,error:S,onStop:function(){P(),Og()},onClear:E}))))},rp=function(){return n.createElement("div",{className:"flex justify-center items-center h-screen"},n.createElement("div",{className:"w-10 h-10 border-4 border-t-transparent border-b-transparent border-r-transparent border-l-blue-600 rounded-full animate-spin"}))},np=r(64583).Promise;function op(e){return op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},op(e)}function ip(){ip=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==op(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(op(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=np);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function ap(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):np.resolve(c).then(n,o)}function sp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var cp=function(e){var t=e.onLogin,r=tu(),o=r.auth,i=r.loginWithMicrosoft,a=r.microsoftAuthError,s=r.isLoggingIn,c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return sp(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sp(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),l=c[0],u=c[1],h=function(e){try{var t;"undefined"!=typeof Office&&null!==(t=Office)&&void 0!==t&&null!==(t=t.context)&&void 0!==t&&null!==(t=t.document)&&void 0!==t&&t.settings&&(Office.context.document.settings.set("isLoggedIn",e),Office.context.document.settings.saveAsync())}catch(e){console.error("Error updating Office settings:",e)}};return(0,n.useEffect)((function(){var e=function(){var e,r=(e=ip().mark((function e(){return ip().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Starting auto-login attempt..."),e.next=4,Kl.getAccount();case 4:if(!e.sent){e.next=20;break}return console.log("Microsoft account found, attempting to get token..."),e.prev=7,e.next=10,Kl.getToken();case 10:return e.sent,console.log("Token obtained successfully"),h(!0),t(),e.abrupt("return");case 17:e.prev=17,e.t0=e.catch(7),console.log("Silent token acquisition failed, trying login...");case 20:return console.log("Attempting interactive Microsoft login..."),e.next=23,i();case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(0),console.error("Auto-login failed:",e.t1);case 28:return e.prev=28,u(!0),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[0,25,28,31],[7,17]])})),function(){var t=this,r=arguments;return new np((function(n,o){var i=e.apply(t,r);function a(e){ap(i,n,o,a,s,"next",e)}function s(e){ap(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();e()}),[]),(0,n.useEffect)((function(){null!=o&&o.accessToken&&(h(!0),t())}),[o]),!l||s?n.createElement("div",{className:"h-screen flex flex-col items-center justify-center bg-gray-50 p-4"},n.createElement("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8"},n.createElement("div",{className:"flex flex-col items-center space-y-4"},n.createElement(Ug,null),n.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Signing in with Microsoft..."),n.createElement(rp,null),n.createElement("p",{className:"text-gray-500 text-sm"},"Please wait while we sign you in automatically")))):a?n.createElement("div",{className:"h-screen flex flex-col items-center justify-center bg-gray-50 p-4"},n.createElement("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8"},n.createElement("div",{className:"flex flex-col items-center space-y-4"},n.createElement(Ug,null),n.createElement("h1",{className:"text-2xl font-bold text-red-600"},"Sign-in Failed"),n.createElement("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm"},a),n.createElement("p",{className:"text-gray-500 text-sm text-center"},"Please try refreshing the page or contact your administrator if the problem persists."),n.createElement("button",{onClick:function(){return window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Retry")))):n.createElement(tp,null)},lp=r(64583).Promise;function up(e){return up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},up(e)}function hp(){hp=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){return Object.defineProperty(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(t,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return c(a,"_invoke",function(t,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=k(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var l=u(t,r,n);if("normal"===l.type){if(o=n.done?4:2,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=4,n.method="throw",n.arg=l.arg)}}}(t,n,new S(o||[])),!0),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h={};function d(){}function g(){}function p(){}var f={};c(f,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(T([])));y&&y!==r&&n.call(y,i)&&(f=y);var v=p.prototype=d.prototype=Object.create(f);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==up(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(t,r){var n=r.method,o=t.i[n];if(o===e)return r.delegate=null,"throw"===n&&t.i.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=u(o,t.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[t.r]=a.value,r.next=t.n,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function C(e){this.tryEntries.push(e)}function I(t){var r=t[4]||{};r.type="normal",r.arg=e,t[4]=r}function S(e){this.tryEntries=[[-1]],e.forEach(C,this),this.reset(!0)}function T(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(up(t)+" is not iterable")}return g.prototype=p,c(v,"constructor",p),c(p,"constructor",g),g.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=lp);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),c(v,s,"Generator"),c(v,i,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e){a.type="throw",a.arg=t,r.next=e}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],l=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!l)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,n(c),!0;if(s<l)return n(l),!1}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[2]===e)return this.complete(r[4],r[3]),I(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]===e){var n=r[4];if("throw"===n.type){var o=n.arg;I(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={i:T(t),r:r,n:n},"next"===this.method&&(this.arg=e),h}},t}function dp(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):lp.resolve(c).then(n,o)}function gp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pp(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pp(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var fp=function(e){try{var t;"undefined"!=typeof Office&&null!==(t=Office)&&void 0!==t&&null!==(t=t.context)&&void 0!==t&&null!==(t=t.document)&&void 0!==t&&t.settings&&(Office.context.document.settings.set("isLoggedIn",e),Office.context.document.settings.saveAsync())}catch(e){console.error("Error updating Office settings:",e)}},mp=function(){var e=gp((0,n.useState)(!1),2),t=e[0],r=e[1],o=gp((0,n.useState)(null),2),i=(o[0],o[1]),a=gp((0,n.useState)("login"),2),s=a[0],c=a[1];(0,n.useEffect)((function(){var e=function(e){console.log("Logout event received:",e),r(!1),i(null),window.location.reload()};window.addEventListener("userLoggedOut",e);var t=function(t){"LOGOUT_SUCCESS"===t.data.type&&(console.log("Logout message received"),e(t))};return window.addEventListener("message",t),l(),function(){window.removeEventListener("userLoggedOut",e),window.removeEventListener("message",t)}}),[]);var l=function(){var e,t=(e=hp().mark((function e(){var t,n;return hp().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(t=Office.context)||void 0===t||null===(t=t.document)||void 0===t||!t.settings){e.next=7;break}if(Office.context.document.settings.get("isLoggedIn")){e.next=7;break}return r(!1),i(null),e.abrupt("return");case 7:return e.next=9,Kl.getAccount();case 9:(n=e.sent)?(r(!0),i(n)):(r(!1),i(null)),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error checking login state:",e.t0),r(!1),i(null);case 18:case"end":return e.stop()}}),e,null,[[0,13]])})),function(){var t=this,r=arguments;return new lp((function(n,o){var i=e.apply(t,r);function a(e){dp(i,n,o,a,s,"next",e)}function s(e){dp(i,n,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,n.useEffect)((function(){var e=setInterval(l,5e3);return function(){return clearInterval(e)}}),[]),t?n.createElement("div",{className:"h-screen flex flex-col items-center justify-center bg-rose-50"},"login"===s?n.createElement(cp,{onLogin:function(){return c("dashboard"),localStorage.setItem("isLoggedIn","true"),void fp(!0)}}):n.createElement(tp,null)):n.createElement(cp,{onLogin:function(){return l()}})},yp=function(){return n.createElement(eu,null,n.createElement(mp,null))};const vp=Symbol.for("fui.slotRenderFunction"),bp=Symbol.for("fui.slotElementType"),wp=Symbol.for("fui.slotClassNameProp");function kp(e){return Boolean(null==e?void 0:e.hasOwnProperty(bp))}function Cp(e,t){return function(r,n,o,i,a){return kp(n)?t(function(e,t){return{...t,[bp]:e}}(r,n),null,o,i,a):kp(r)?t(r,n,o,i,a):e(r,n,o,i,a)}}function Ip(e){const{as:t,[wp]:r,[bp]:n,[vp]:o,...i}=e,a=i,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:o}}r(44363);var Sp=r(74848);const Tp=r.t(Sp,2),xp=Cp(Tp.jsx,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=Ip(e),s={...a,...t};return i?Tp.jsx(n.Fragment,{children:i(o,s)},r):Tp.jsx(o,s,r)})),Ap=Cp(Tp.jsxs,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=Ip(e),s={...a,...t};return i?Tp.jsx(n.Fragment,{children:i(o,{...s,children:Tp.jsxs(n.Fragment,{children:s.children},void 0)})},r):Tp.jsxs(o,s,r)}));function Ep(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const _p=n.createContext("ltr"),Pp=({children:e,dir:t})=>n.createElement(_p.Provider,{value:t},e),Rp=n.createContext(void 0),Op={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},Np=Rp.Provider;function Mp(){var e;return null!==(e=n.useContext(Rp))&&void 0!==e?e:Op}const qp=n.createContext(void 0),Lp=qp.Provider,Bp=n.createContext(void 0).Provider,Hp=n.createContext(void 0),Fp=Hp.Provider,Dp=n.createContext(void 0).Provider,Up=n.createContext(void 0),zp=Up.Provider,jp=n.createContext(void 0).Provider,$p="undefined"==typeof window?r.g:window,Kp="@griffel/";function Gp(e,t){return $p[Symbol.for(Kp+e)]||($p[Symbol.for(Kp+e)]=t),$p[Symbol.for(Kp+e)]}const Wp=Gp("DEFINITION_LOOKUP_TABLE",{}),Qp="data-make-styles-bucket";const Vp=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((e,t,r)=>(e[t]=r,e)),{});function Jp(e,t,r,n,o={}){var i,a;const s="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(a=o.p)&&void 0!==a?a:0,u=function(e,t,r){return("m"===e?e+t:e)+r}(e,c,l);if(!n.stylesheets[u]){const i=t&&t.createElement("style"),a=function(e,t,r,n){const o=[];if(n[Qp]=t,n["data-priority"]=String(r),e)for(const t in n)e.setAttribute(t,n[t]);return{elementAttributes:n,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map((e=>e.cssText)):o}}}(i,e,l,Object.assign({},n.styleElementAttributes,s&&{media:c}));n.stylesheets[u]=a,(null==t?void 0:t.head)&&i&&t.head.insertBefore(i,function(e,t,r,n,o={}){var i,a;const s=Vp[r],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(a=o.p)&&void 0!==a?a:0;let u=e=>s-Vp[e.getAttribute(Qp)],h=e.head.querySelectorAll(`[${Qp}]`);if("m"===r){const t=e.head.querySelectorAll(`[${Qp}="${r}"]`);t.length&&(h=t,u=e=>n.compareMediaQueries(c,e.media))}const d=h.length;let g=d-1;for(;g>=0;){const e=h.item(g);if((function(e,t,r){var n,o;return t+(null!==(n=r.m)&&void 0!==n?n:"")===e.getAttribute(Qp)+(null!==(o=e.media)&&void 0!==o?o:"")}(p=e,r,o)?l-Number(p.getAttribute("data-priority")):u(p))>0)return e.nextSibling;g--}var p;return d>0?h.item(0):t?t.nextSibling:null}(t,r,e,n,o))}return n.stylesheets[u]}function Yp(e,t){try{e.insertRule(t)}catch(e){}}let Xp=0;const Zp=(e,t)=>e<t?-1:e>t?1:0;function ef(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:r,unstable_filterCSSRule:n,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=Zp}=t,s={classNameHashSalt:r,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d"+Xp++,insertCSSRules(t){for(const i in t){const a=t[i];for(let t=0,c=a.length;t<c;t++){const[c,l]=(r=a[t],Array.isArray(r)?r:[r]),u=Jp(i,e,o||null,s,l);s.insertionCache[c]||(s.insertionCache[c]=i,n?n(c)&&Yp(u,c):Yp(u,c))}}var r}};return s}const tf=n.createContext(ef());function rf(){return n.useContext(tf)}function nf(e,t){var r;const n=e;var o;return Boolean((null==n||null===(r=n.ownerDocument)||void 0===r?void 0:r.defaultView)&&n instanceof n.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var of="undefined"!=typeof WeakRef,af=class{constructor(e){of&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let r;return this._weakRef?(r=null==(e=this._weakRef)?void 0:e.deref(),r||delete this._weakRef):(r=this._instance,(null==(t=null==r?void 0:r.isDisposed)?void 0:t.call(r))&&delete this._instance),r}},sf="keyborg:focusin",cf=!1,lf=0,uf=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout((()=>{delete this._isMouseOrTouchUsedTimer}),1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++lf,this._win=e;const r=e.document;if(t){const e=t.triggerKeys,r=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==r?void 0:r.length)&&(this._dismissKeys=new Set(r))}r.addEventListener(sf,this._onFocusIn,!0),r.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),r.addEventListener("touchstart",this._onMouseOrTouch,!0),r.addEventListener("touchend",this._onMouseOrTouch,!0),r.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;cf||(cf=function(e){const t=e.HTMLElement,r=t.prototype.focus;let n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=r,n}(t));const r=t.HTMLElement.prototype.focus;if(r.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=c;const n=new Set,o=e=>{const t=e.target;if(!t)return;const r=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(r)},i=e=>{const t=e.target;if(!t)return;let r=e.composedPath()[0];const s=new Set;for(;r;)r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(r),r=r.host):r=r.parentNode;for(const e of n){const t=e.deref();t&&s.has(t)||(n.delete(e),t&&(t.removeEventListener("focusin",i,!0),t.removeEventListener("focusout",o,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,r)=>{var a;const c=e.shadowRoot;if(c){for(const e of n)if(e.deref()===c)return;return c.addEventListener("focusin",i,!0),c.addEventListener("focusout",o,!0),void n.add(new af(c))}const l={relatedTarget:t,originalEvent:r},u=new CustomEvent(sf,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(cf||s.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(a=s.lastFocusedProgrammatically)?void 0:a.deref()),s.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},s=t.__keyborgData={focusInHandler:i,focusOutHandler:o,shadowTargets:n};function c(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new af(this)),r.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)a(l),l=l.shadowRoot.activeElement;c.__keyborgNativeFocus=r}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,r=t.HTMLElement.prototype,n=r.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}n&&(r.focus=n)}(e);const t=e.document;t.removeEventListener(sf,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const r=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(r)for(const e of Object.keys(r))hf.update(r[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const r=null==(t=this._win)?void 0:t.document.activeElement,n=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable);return n&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout((()=>{this._dismissTimer=void 0;const r=e.document.activeElement;t&&r&&t===r&&(this.isNavigatingWithKeyboard=!1)}),500)}}},hf=class e{constructor(e,t){this._cb=[],this._id="k"+ ++lf,this._win=e;const r=e.__keyborg;r?(this._core=r.core,r.refs[this._id]=this):(this._core=new uf(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,r){return new e(t,r)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach((e=>e(t)))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const df="data-fui-focus-visible";function gf(e,t){if(pf(e))return()=>{};const r={current:void 0},n=(o=t,hf.create(o,undefined));var o;function i(e){n.isNavigatingWithKeyboard()&&nf(e)&&(r.current=e,e.setAttribute(df,""))}function a(){r.current&&(r.current.removeAttribute(df),r.current=void 0)}n.subscribe((e=>{e?i(t.document.activeElement):a()}));const s=e=>{a(),i(e.composedPath()[0])},c=t=>{(!t.relatedTarget||nf(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(sf,s),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{var t;a(),e.removeEventListener(sf,s),e.removeEventListener("focusout",c),delete e.focusVisible,t=n,hf.dispose(t)}}function pf(e){return!!e&&(!!e.focusVisible||pf(null==e?void 0:e.parentElement))}function ff(e={}){const t=Mp(),r=n.useRef(null);var o;const i=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return n.useEffect((()=>{if((null==i?void 0:i.defaultView)&&r.current)return gf(r.current,i.defaultView)}),[r,i]),r}function mf(e,t){const{defaultProps:r,elementType:o}=t,i=function(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||n.isValidElement(e)?{children:e}:e}(e),a={...r,...i,[bp]:o,[wp]:null==i?void 0:i.className};return i&&"function"==typeof i.children&&(a[vp]=i.children,a.children=null==r?void 0:r.children),a}const yf=(...e)=>{const t={};for(const r of e){const e=Array.isArray(r)?r:Object.keys(r);for(const r of e)t[r]=1}return t},vf=yf(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),bf=yf(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),wf=yf(["itemID","itemProp","itemRef","itemScope","itemType"]),kf=yf(bf,vf,wf),Cf=yf(kf,["form"]),If=yf(kf,["height","loop","muted","preload","src","width"]),Sf=yf(If,["poster"]),Tf=yf(kf,["start"]),xf=yf(kf,["value"]),Af=yf(kf,["download","href","hrefLang","media","rel","target","type"]),Ef=yf(kf,["dateTime"]),_f=yf(kf,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),Pf={label:Cf,audio:If,video:Sf,ol:Tf,li:xf,a:Af,button:_f,input:yf(_f,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:yf(_f,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:yf(_f,["form","multiple","required"]),option:yf(kf,["selected","value"]),table:yf(kf,["cellPadding","cellSpacing"]),tr:kf,th:yf(kf,["colSpan","rowSpan","scope"]),td:yf(kf,["colSpan","headers","rowSpan","scope"]),colGroup:yf(kf,["span"]),col:yf(kf,["span"]),fieldset:yf(kf,["disabled","form"]),form:yf(kf,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:yf(kf,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:yf(kf,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:Ef,dialog:yf(kf,["open","onCancel","onClose"])};const Rf=(e,t,r)=>{var n;return function(e,t,r){const n=e&&Pf[e]||kf;return n.as=1,function(e,t,r){const n=Array.isArray(t),o={},i=Object.keys(e);for(const a of i)!(!n&&t[a]||n&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||r&&-1!==(null==r?void 0:r.indexOf(a))||(o[a]=e[a]);return o}(t,n,r)}(null!==(n=t.as)&&void 0!==n?n:e,t,r)};function Of(...e){const t=n.useCallback((r=>{t.current=r;for(const t of e)"function"==typeof t?t(r):t&&(t.current=r)}),[...e]);return t}const Nf=Ep()?n.useLayoutEffect:n.useEffect,Mf={current:0},qf=n.createContext(void 0);const Lf=n.createContext(void 0);function Bf(e="fui-",t){const r=null!==(s=n.useContext(qf))&&void 0!==s?s:Mf,i=n.useContext(Lf)||"",a=o.useId;var s;if(a){const r=a(),o=n.useMemo((()=>r.replace(/:/g,"")),[r]);return t||`${i}${e}${o}`}return n.useMemo((()=>t||`${i}${e}${++r.current}`),[i,e,t,r])}Lf.Provider;const Hf=()=>{const e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function Ff(e,t,r=[]){return"___"+function(e){const t=e.length;if(7===t)return e;for(let r=t;r<7;r++)e+="0";return e}(function(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(e+t))}function Df(e,t){let r="",n="";for(const o in e){const i=e[o];if(0===i){n+=o+" ";continue}const a=Array.isArray(i),s="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=s,n+=s}return[r.slice(0,-1),n.slice(0,-1)]}function Uf(e,t){const r={};for(const n in e){const[o,i]=Df(e[n],t);if(""===i){r[n]="";continue}const a=Ff(i,t),s=a+(""===o?"":" "+o);Wp[a]=[e[n],t],r[n]=s}return r}function zf(e,t,r=Hf){const n=r();let o=null,i=null;return function(r){const{dir:a,renderer:s}=r,c="ltr"===a;return c?null===o&&(o=Uf(e,a)):null===i&&(i=Uf(e,a)),n(s,t),c?o:i}}const jf={},$f="fui-FluentProvider",Kf=zf({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Gf=o.useInsertionEffect?o.useInsertionEffect:Nf,Wf={},Qf={},Vf=(e,t)=>{const r=Mp(),o=n.useContext(qp),i=null!==(a=n.useContext(Up))&&void 0!==a?a:{};var a;const s=n.useContext(Hp)||Wf,{applyStylesToPortals:c=!0,customStyleHooks_unstable:l,dir:u=r.dir,targetDocument:h=r.targetDocument,theme:d,overrides_unstable:g={}}=e,p=Jf(o,d),f=Jf(i,g),m=Jf(s,l),y=rf();var v;const{styleTagId:b,rule:w}=(e=>{const{targetDocument:t,theme:r,rendererAttributes:o}=e,i=n.useRef(),a=Bf($f),s=o,c=n.useMemo((()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce(((e,r)=>`${e}--${r}: ${t[r]}; `),"")} }`:`${e} {}`}(`.${a}`,r)),[r,a]);return function(e,t){n.useState((()=>{if(!e)return;const r=e.getElementById(t);r&&e.head.append(r)}))}(t,a),Gf((()=>{const e=null==t?void 0:t.getElementById(a);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const r=e.createElement("style");return Object.keys(t).forEach((e=>{r.setAttribute(e,t[e])})),e.head.appendChild(r),r})(t,{...s,id:a}),i.current&&((e,t)=>{const r=e.sheet;r&&(r.cssRules.length>0&&r.deleteRule(0),r.insertRule(t,0))})(i.current,c)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}}),[a,t,c,s]),{styleTagId:a,rule:c}})({theme:p,targetDocument:h,rendererAttributes:null!==(v=y.styleElementAttributes)&&void 0!==v?v:Qf});return{applyStylesToPortals:c,customStyleHooks_unstable:m,dir:u,targetDocument:h,theme:p,overrides_unstable:f,themeClassName:b,components:{root:"div"},root:mf(Rf("div",{...e,dir:u,ref:Of(t,ff({targetDocument:h}))}),{elementType:"div"}),serverStyleProps:{cssRule:w,attributes:{...y.styleElementAttributes,id:b}}}};function Jf(e,t){return e&&t?{...e,...t}:e||t}const Yf=n.forwardRef(((e,t)=>{const r=Vf(e,t);(e=>{const t=rf(),r=Kf({dir:e.dir,renderer:t});e.root.className=function(){let e=null,t="",r="";const n=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const i=o.indexOf("___");if(-1===i)t+=o+" ";else{const a=o.substr(i,10);i>0&&(t+=o.slice(0,i)),r+=a,n[e]=a}}}if(""===r)return t.slice(0,-1);const o=jf[r];if(void 0!==o)return t+o;const i=[];for(let t=0;t<arguments.length;t++){const r=n[t];if(r){const t=Wp[r];t&&(i.push(t[0]),e=t[1])}}const a=Object.assign.apply(Object,[{}].concat(i)),[s,c]=Df(a,e),l=Ff(c,e,n),u=l+" "+s;return jf[r]=u,Wp[l]=[a,e],t+u}($f,e.themeClassName,r.root,e.root.className)})(r);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:r,dir:o,root:i,targetDocument:a,theme:s,themeClassName:c,overrides_unstable:l}=e,u=n.useMemo((()=>({dir:o,targetDocument:a})),[o,a]),[h]=n.useState((()=>({}))),d=n.useMemo((()=>({textDirection:o})),[o]);return{customStyleHooks_unstable:r,overrides_unstable:l,provider:u,textDirection:o,iconDirection:d,tooltip:h,theme:s,themeClassName:t?i.className:c}}(r);return((e,t)=>xp(Np,{value:t.provider,children:xp(Lp,{value:t.theme,children:xp(Bp,{value:t.themeClassName,children:xp(Fp,{value:t.customStyleHooks_unstable,children:xp(Dp,{value:t.tooltip,children:xp(Pp,{dir:t.textDirection,children:xp(jp,{value:t.iconDirection,children:xp(zp,{value:t.overrides_unstable,children:Ap(e.root,{children:[Ep()?null:xp("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(r,o)}));Yf.displayName="FluentProvider";const Xf="#242424",Zf="#424242",em="#616161",tm="#bdbdbd",rm="#e0e0e0",nm="#e6e6e6",om="#ebebeb",im="#f0f0f0",am="#f5f5f5",sm="#fafafa",cm="rgba(255, 255, 255, 0.4)",lm="rgba(255, 255, 255, 0.5)",um="rgba(0, 0, 0, 0.05)",hm="rgba(0, 0, 0, 0.1)",dm="#ffffff",gm={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},pm={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},fm={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:pm,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},mm={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:gm,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},ym={cranberry:gm,green:pm,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},vm={success:"green",warning:"orange",danger:"cranberry"},bm=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:fm[t].tint60,[`colorPalette${r}Background2`]:fm[t].tint40,[`colorPalette${r}Background3`]:fm[t].primary,[`colorPalette${r}Foreground1`]:fm[t].shade10,[`colorPalette${r}Foreground2`]:fm[t].shade30,[`colorPalette${r}Foreground3`]:fm[t].primary,[`colorPalette${r}BorderActive`]:fm[t].primary,[`colorPalette${r}Border1`]:fm[t].tint40,[`colorPalette${r}Border2`]:fm[t].primary};return Object.assign(e,n)}),{});bm.colorPaletteYellowForeground1=fm.yellow.shade30,bm.colorPaletteRedForegroundInverted=fm.red.tint20,bm.colorPaletteGreenForegroundInverted=fm.green.tint20,bm.colorPaletteYellowForegroundInverted=fm.yellow.tint40;const wm=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:mm[t].tint40,[`colorPalette${r}Foreground2`]:mm[t].shade30,[`colorPalette${r}BorderActive`]:mm[t].primary};return Object.assign(e,n)}),{}),km={...bm,...wm},Cm=Object.entries(vm).reduce(((e,[t,r])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${n}Background1`]:ym[r].tint60,[`colorStatus${n}Background2`]:ym[r].tint40,[`colorStatus${n}Background3`]:ym[r].primary,[`colorStatus${n}Foreground1`]:ym[r].shade10,[`colorStatus${n}Foreground2`]:ym[r].shade30,[`colorStatus${n}Foreground3`]:ym[r].primary,[`colorStatus${n}ForegroundInverted`]:ym[r].tint30,[`colorStatus${n}BorderActive`]:ym[r].primary,[`colorStatus${n}Border1`]:ym[r].tint40,[`colorStatus${n}Border2`]:ym[r].primary};return Object.assign(e,o)}),{});Cm.colorStatusDangerBackground3Hover=ym[vm.danger].shade10,Cm.colorStatusDangerBackground3Pressed=ym[vm.danger].shade20,Cm.colorStatusWarningForeground1=ym[vm.warning].shade20,Cm.colorStatusWarningForeground3=ym[vm.warning].shade20,Cm.colorStatusWarningBorder2=ym[vm.warning].shade20;const Im={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},Sm={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},Tm={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},xm={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},Am={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},Em={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function _m(e,t,r=""){return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const Pm={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},Rm={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},Om="10px",Nm="12px",Mm="16px",qm="20px",Lm="24px",Bm="32px",Hm={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:Om,spacingHorizontalM:Nm,spacingHorizontalL:Mm,spacingHorizontalXL:qm,spacingHorizontalXXL:Lm,spacingHorizontalXXXL:Bm},Fm={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:Om,spacingVerticalM:Nm,spacingVerticalL:Mm,spacingVerticalXL:qm,spacingVerticalXXL:Lm,spacingVerticalXXXL:Bm},Dm=(()=>{const e=(e=>({colorNeutralForeground1:Xf,colorNeutralForeground1Hover:Xf,colorNeutralForeground1Pressed:Xf,colorNeutralForeground1Selected:Xf,colorNeutralForeground2:Zf,colorNeutralForeground2Hover:Xf,colorNeutralForeground2Pressed:Xf,colorNeutralForeground2Selected:Xf,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:em,colorNeutralForeground3Hover:Zf,colorNeutralForeground3Pressed:Zf,colorNeutralForeground3Selected:Zf,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:tm,colorNeutralForegroundInvertedDisabled:cm,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:Zf,colorNeutralForeground2LinkHover:Xf,colorNeutralForeground2LinkPressed:Xf,colorNeutralForeground2LinkSelected:Xf,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:Xf,colorNeutralForegroundStaticInverted:dm,colorNeutralForegroundInverted:dm,colorNeutralForegroundInvertedHover:dm,colorNeutralForegroundInvertedPressed:dm,colorNeutralForegroundInvertedSelected:dm,colorNeutralForegroundInverted2:dm,colorNeutralForegroundOnBrand:dm,colorNeutralForegroundInvertedLink:dm,colorNeutralForegroundInvertedLinkHover:dm,colorNeutralForegroundInvertedLinkPressed:dm,colorNeutralForegroundInvertedLinkSelected:dm,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:dm,colorNeutralBackground1Hover:am,colorNeutralBackground1Pressed:rm,colorNeutralBackground1Selected:om,colorNeutralBackground2:sm,colorNeutralBackground2Hover:im,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:nm,colorNeutralBackground3:am,colorNeutralBackground3Hover:om,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:rm,colorNeutralBackground4:im,colorNeutralBackground4Hover:sm,colorNeutralBackground4Pressed:am,colorNeutralBackground4Selected:dm,colorNeutralBackground5:om,colorNeutralBackground5Hover:am,colorNeutralBackground5Pressed:im,colorNeutralBackground5Selected:sm,colorNeutralBackground6:nm,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:lm,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:am,colorSubtleBackgroundPressed:rm,colorSubtleBackgroundSelected:om,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:lm,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:hm,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:im,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:nm,colorNeutralStencil2:sm,colorNeutralStencil1Alpha:hm,colorNeutralStencil2Alpha:um,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:dm,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:sm,colorNeutralCardBackgroundHover:dm,colorNeutralCardBackgroundPressed:am,colorNeutralCardBackgroundSelected:om,colorNeutralCardBackgroundDisabled:im,colorNeutralStrokeAccessible:em,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:tm,colorNeutralStroke2:rm,colorNeutralStroke3:im,colorNeutralStrokeSubtle:rm,colorNeutralStrokeOnBrand:dm,colorNeutralStrokeOnBrand2:dm,colorNeutralStrokeOnBrand2Hover:dm,colorNeutralStrokeOnBrand2Pressed:dm,colorNeutralStrokeOnBrand2Selected:dm,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:rm,colorNeutralStrokeInvertedDisabled:cm,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:um,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:dm,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...Im,...Sm,...Tm,...Am,...xm,...Em,...Hm,...Fm,...Pm,...Rm,...e,...km,...Cm,..._m(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),..._m(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var Um=document.getElementById("container"),zm=Um?(0,i.H)(Um):void 0,jm=function(){return n.useEffect((function(){["documentSummary","selectedText","selectedTextForProcessing"].forEach((function(e){localStorage.removeItem(e)}))}),[]),n.createElement(Yf,{theme:Dm},n.createElement(yp,null))};Office.onReady((function(){null==zm||zm.render(n.createElement(jm,null))}))}},function(e){var t=function(t){return e(e.s=t)};t(80804),t(39046)}]);
//# sourceMappingURL=taskpane.js.map